import EP_FUNCTIONS:EP_Utilities;

class WorkCenterUI
   method WorkCenterUI();
   method EC_substeps(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt1(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt2(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt3(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt4(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt5(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt6(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt7(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt8(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt9(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt10(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt11(&rssubstep As Rowset, &HeaderRec As Record);
   
   method MGR_Chkpt1_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt2_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt3_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt4_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt5_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt6_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt7_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt8_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt9_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt10_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method MGR_Chkpt11_UI(&rssubstep As Rowset, &HeaderRec As Record);
   
   
   method EE_Chkpt1(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt2(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt3(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt4(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt5(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt6(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt7(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt8(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt9(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt10(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt11(&rssubstep As Rowset, &HeaderRec As Record);
   
   method EE_Chkpt1_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt2_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt3_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt4_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt5_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt6_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt7_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt8_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt9_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt10_UI(&rssubstep As Rowset, &HeaderRec As Record);
   method EE_Chkpt11_UI(&rssubstep As Rowset, &HeaderRec As Record);
   
   method CHKPT_Substeps(&rssubstep As Rowset, &HeaderRec As Record, &ECstepexist As boolean);
   method Final_substeps(&rssubstep As Rowset, &HeaderRec As Record, &ECstepexist As boolean);
   method Nominate_substeps(&rssubstep As Rowset, &HeaderRec As Record);
   method View_Participant_substep(&rssubstep As Rowset, &HeaderRec As Record);
   method Self_Substeps(&rssubstep As Rowset, &HeaderRec As Record, &strEmpDocStatus As string, &bolEmpDocDoesExist As boolean);
   method Manager_substeps(&rssubstep As Rowset, &HeaderRec As Record, &strEmpDocStatus As string, &strMgrDocStatus As string, &bolMgrDocDoesExist As boolean);
   
private
   instance integer &i, &j;
end-class;

Declare Function GetText PeopleCode FUNCLIB_EP.HR_SSTEXT_KEY1 FieldFormula;
Declare Function GetSimpleText PeopleCode FUNCLIB_EP.HR_SSTEXT_KEY1 FieldFormula;
Declare Function GetSimpleTextSub PeopleCode FUNCLIB_EP.HR_SSTEXT_KEY1 FieldFormula;
Global Record &EP_GBLKEYS_WRK;
Global boolean &HasAccess_EC, &HasAccess_TP, &GBL_Step_Cmplt, &Gbl_same_focus, &GBL_TP_same_focus;
Component string &CMP_AutoStarted;

/* Substep rows */
Component Row &rowEstSubUpdate;
Component Row &rowEstSubUpdateandApprove;
Component Row &rowEstSubView;
Component Row &rowEstSubReopen;


Component Row &rowChkSub1UpdateandShare;
Component Row &rowChkSub2UpdateandShare;
Component Row &rowChkSub3UpdateandShare;
Component Row &rowChkSub4UpdateandShare;
Component Row &rowChkSub5UpdateandShare;
Component Row &rowChkSub6UpdateandShare;
Component Row &rowChkSub7UpdateandShare;
Component Row &rowChkSub8UpdateandShare;
Component Row &rowChkSub9UpdateandShare;
Component Row &rowChkSub10UpdateandShare;
Component Row &rowChkSub11UpdateandShare;
Component Row &rowChkSub1ReviewwithEmployee;
Component Row &rowChkSub2ReviewwithEmployee;
Component Row &rowChkSub3ReviewwithEmployee;
Component Row &rowChkSub4ReviewwithEmployee;
Component Row &rowChkSub5ReviewwithEmployee;
Component Row &rowChkSub6ReviewwithEmployee;
Component Row &rowChkSub7ReviewwithEmployee;
Component Row &rowChkSub8ReviewwithEmployee;
Component Row &rowChkSub9ReviewwithEmployee;
Component Row &rowChkSub10ReviewwithEmployee;
Component Row &rowChkSub11ReviewwithEmployee;
Component Row &rowChkSub1View;
Component Row &rowChkSub2View;
Component Row &rowChkSub3View;
Component Row &rowChkSub4View;
Component Row &rowChkSub5View;
Component Row &rowChkSub6View;
Component Row &rowChkSub7View;
Component Row &rowChkSub8View;
Component Row &rowChkSub9View;
Component Row &rowChkSub10View;
Component Row &rowChkSub11View;

/* reopen checkpoints */
Component Row &rowChkSub1Reopen;
Component Row &rowChkSub2Reopen;
Component Row &rowChkSub3Reopen;
Component Row &rowChkSub4Reopen;
Component Row &rowChkSub5Reopen;
Component Row &rowChkSub6Reopen;
Component Row &rowChkSub7Reopen;
Component Row &rowChkSub8Reopen;
Component Row &rowChkSub9Reopen;
Component Row &rowChkSub10Reopen;
Component Row &rowChkSub11Reopen;

Component Row &rowFinalSubUpdateandClose;
Component Row &rowFinalSubview;
Component Row &rowFinalSubReopen;

Component Row &rowNomSubAdd;
Component Row &rowNomSubViewNom;
Component Row &rowNomSubTrk;
Component Row &rowPrtSubView;
Component Row &rowEmpSubupdateandComplete;
Component Row &rowEmpSubView;

Component Row &rowMgrSubUpdateandSubmit;
Component Row &rowMgrSubApproval;
Component Row &rowMgrSubUpdateandComplete;
Component Row &rowMgrSubUpdateandShare;
Component Row &rowMgrSubReqestAcknowledgement;
Component Row &rowMgrSubOverrideAcknowledgement;
Component Row &rowMgrSubPA;
Component Row &rowMgrSubComplete;
Component Row &rowMgrSubView;

/* Constructor - Dummy constructor method. Used to instantiate the class.*/

method WorkCenterUI
end-method;


/* Work Center Sub Steps */

method EC_substeps
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   
   
   Local EP_FUNCTIONS:EP_Utilities &EP_Utilities = create EP_FUNCTIONS:EP_Utilities();
   
   Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
   When = "M"
      
      Evaluate &HeaderRec.EP_EST_STATUS.Value
         /* Establish Criteria Status is in progress */
      When = "NS"
      When = "IP"
         /* If Manager Establish Update Switch is on and Document is not canceled, Show Update and Show View, Hide Update and Approve */
         If &HeaderRec.EP_EST_UPD_MGR_SW.Value = "Y" And
               &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
            &rowEstSubUpdate.Visible = True;
            &rowEstSubUpdate.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowEstSubUpdate.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowEstSubUpdate.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowEstSubUpdate.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = &HeaderRec.EP_EST_STATUS.LongTranslateValue;
            &rowEstSubUpdate.Style = "PSGRIDROWSELECTED";
            &rowEstSubUpdateandApprove.Visible = False;
            &rowEstSubView.Visible = False;
            /* If Establish Criteria Completes by Manager and Document is not canceled, Show: Update and Approve, Show View, hide Update */
            If &HeaderRec.EP_EST_CMP_ROLE.Value = "M" Then
               &rowEstSubUpdate.Visible = False;
               &rowEstSubUpdateandApprove.Visible = True;
               &rowEstSubUpdateandApprove.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowEstSubUpdateandApprove.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowEstSubUpdateandApprove.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowEstSubUpdateandApprove.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = &HeaderRec.EP_EST_STATUS.LongTranslateValue;
               &rowEstSubUpdateandApprove.Style = "PSGRIDROWSELECTED";
               &rowEstSubView.Visible = False;
            Else
               &rowEstSubUpdate.Visible = True;
               &rowEstSubUpdateandApprove.Visible = False;
               &rowEstSubView.Visible = False;
            End-If;
            
         Else
            
            &rowEstSubUpdate.Visible = False;
            &rowEstSubUpdateandApprove.Visible = False;
            &rowEstSubView.Visible = True;
            
         End-If;
         
         
         Break;
         
         
      When = "CO"
         /* Establish Criteria is Completed, Show View, hide update, hide update and Approve  */
         &rowEstSubView.Visible = True;
         &rowEstSubView.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
         &rowEstSubUpdateandApprove.Visible = False;
         &rowEstSubUpdate.Visible = False;
         
         Break;
      When = "CA"
         &rowEstSubView.Visible = True;
         &rowEstSubUpdateandApprove.Visible = False;
         &rowEstSubUpdate.Visible = False;
         Break;
      When-Other
         Break;
      End-Evaluate;
      
   When = "E"
      
      
      &rowEstSubUpdateandApprove.Visible = False;
      &rowEstSubView.Visible = False;
      Evaluate &HeaderRec.EP_EST_STATUS.Value
         /* Establish Criteria Status is in progress */
      When = "NS"
      When = "IP"
         /* If Employee Establish Update Switch is on and Document is not canceled, Show Update and Show View, Hide Update and Approve */
         If &HeaderRec.EP_EST_UPD_EE_SW.Value = "Y" And
               &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
            &rowEstSubUpdate.Visible = True;
            &rowEstSubUpdate.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowEstSubUpdate.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowEstSubUpdate.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowEstSubUpdate.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = &HeaderRec.EP_EST_STATUS.LongTranslateValue;
            &rowEstSubUpdate.Style = "PSGRIDROWSELECTED";
            &rowEstSubUpdateandApprove.Visible = False;
            &rowEstSubView.Visible = False;
            /* If Employee Establish Update Switch is on and Establish Criteria Completes by Employee and Document is not canceled, Show: Update and Approve, Show View, hide Update */
            If &HeaderRec.EP_EST_CMP_ROLE.Value = "E" Then
               &rowEstSubUpdateandApprove.Visible = True;
               &rowEstSubUpdateandApprove.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowEstSubUpdateandApprove.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowEstSubUpdateandApprove.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowEstSubUpdateandApprove.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = &HeaderRec.EP_EST_STATUS.LongTranslateValue;
               &rowEstSubUpdateandApprove.Style = "PSGRIDROWSELECTED";
               &rowEstSubView.Visible = False;
               &rowEstSubUpdate.Visible = False;
            Else
               &rowEstSubUpdate.Visible = True;
               
            End-If;
         Else
            
            &rowEstSubUpdate.Visible = False;
            &rowEstSubUpdateandApprove.Visible = False;
            &rowEstSubView.Visible = True;
            
         End-If;
         
         
         Break;
         /* Establish Criteria is Completed, Show View, Hide Update, Hide update and Approve */
         
      When = "CO"
         
         &rowEstSubView.Visible = True;
         &rowEstSubUpdate.Visible = False;
         &rowEstSubUpdateandApprove.Visible = False;
         
         Break;
         
         
      When-Other
         Break;
      End-Evaluate;
      
   When = "H"
   When = "V"
   When = "A"
      
      /* If User Role is Admin, View only and Approver, Show View, Hide Update, Hide Update and Approve */
      &rowEstSubView.Visible = True;
      &rowEstSubUpdate.Visible = False;
      &rowEstSubUpdateandApprove.Visible = False;
      Break;
   When-Other;
      Break;
   End-Evaluate;
   /* If Admin or view-only Logs in and Define Criteria has started yet, disable the view link */
   
   If (&EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Or
         &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V") And
         &HeaderRec.EP_EST_STATUS.Value = "NS" Then
      &rowEstSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   End-If;
   
   
   Local string &RoleDocStatus;
   SQLExec(SQL.EP_ROLE_STATUS, &EP_GBLKEYS_WRK.EP_APPRAISAL_ID.Value, &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, &RoleDocStatus);
   /* This will be a method later */
   If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
      If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
            &HeaderRec.EP_EST_STATUS.Value = "IP" Or
            (&HeaderRec.EP_EST_STATUS.Value = "CO" And
               &HeaderRec.EP_TRKPROG_STATUS.Value = "NS") Or
            (&HeaderRec.EP_EST_STATUS.Value = "CO" And
               &HeaderRec.EP_TRKPROG_STATUS.Value = "NA" And
               None(&RoleDocStatus)) Or
            (&HeaderRec.EP_EST_STATUS.Value = "CO" And
               &HeaderRec.EP_TRKPROG_STATUS.Value = "NA" And
               &RoleDocStatus = "NS") Then
         
         &rowEstSubView.Visible = True;
         &rowEstSubUpdate.Visible = False;
         &rowEstSubUpdateandApprove.Visible = False;
         
      End-If;
   End-If;
   
   
   
   
   /* If no access to EC step and Establish Criteria is not started, disable all sub-steps */
   If &HasAccess_EC = False And
         &HeaderRec.EP_EST_STATUS.Value = "NS" Then
      &rowEstSubUpdate.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowEstSubUpdateandApprove.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowEstSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   /*  logic to display or hide the EC re-open hyperlink  */
   
   /*Hide Reopen first */
   &rowEstSubReopen.Visible = False;
   
   
   If &CMP_AutoStarted = "TP" Or
         (&CMP_AutoStarted = "EV" And
            &HeaderRec.EP_TP_STEP_SW.Value = "N") Then
      /*  Track Progress step was auto-started, check to see whether or not to display the EC re-open link  */
      Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
      When = "E"
         If (&HeaderRec.EP_EST_CMP_ROLE.Value = "B" Or
               &HeaderRec.EP_EST_CMP_ROLE.Value = "E") And
               &EP_Utilities.CanReOpenBaseline(&HeaderRec.EP_APPRAISAL_ID.Value) Then
            &rowEstSubReopen.Visible = True;
         End-If;
         Break;
         
      When = "M"
         
         If (&HeaderRec.EP_EST_CMP_ROLE.Value = "M" Or
               &HeaderRec.EP_EST_CMP_ROLE.Value = "B") And
               &EP_Utilities.CanReOpenBaseline(&HeaderRec.EP_APPRAISAL_ID.Value) Then
            &rowEstSubReopen.Visible = True;
         End-If;
         Break;
      When = "H"
         If &EP_Utilities.CanReOpenBaseline(&HeaderRec.EP_APPRAISAL_ID.Value) Then
            &rowEstSubReopen.Visible = True;
         End-If;
         Break;
      End-Evaluate;
   End-If;
   
   
end-method;

method MGR_Chkpt1
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Checkpoint, manager can update, and comments not shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then */
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         
         &rowChkSub1UpdateandShare.Visible = True;
         &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            If &GBL_TP_same_focus Then
            Else
               &rowChkSub1UpdateandShare.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub1ReviewwithEmployee.Visible = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      Else
         /*WW*/
         &rowChkSub1UpdateandShare.Visible = True;
         &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub1ReviewwithEmployee.Visible = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   
   /* Check points, manager can update and manager comments are shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub1UpdateandShare.Visible = True;
         &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
            &rowChkSub1UpdateandShare.Style = "PSGRIDROWSELECTED";
         Else
         End-If;
         
         &rowChkSub1ReviewwithEmployee.Visible = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub1ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      Else
         &rowChkSub1ReviewwithEmployee.Visible = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   
   
   
end-method;

method MGR_Chkpt1_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   &WorkCenterUI.MGR_Chkpt1(&rssubstep, &HeaderRec);
   &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   
   
end-method;

method MGR_Chkpt2
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Checkpoint, manager can update, and comments not shared */
   
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then */
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         /* Show check point 2 step's substeps */
         &rowChkSub2UpdateandShare.Visible = True;
         &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            If &GBL_TP_same_focus Then
            Else
               &rowChkSub2UpdateandShare.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowChkSub2ReviewwithEmployee.Visible = True;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      Else
         &rowChkSub2UpdateandShare.Visible = True;
         &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   
   
   /* Check points, manager can update and manager comments are shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then */
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub2UpdateandShare.Visible = True;
         &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
            &rowChkSub2UpdateandShare.Style = "PSGRIDROWSELECTED";
         Else
         End-If;
         &rowChkSub2ReviewwithEmployee.Visible = True;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub2ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      Else
         &rowChkSub2ReviewwithEmployee.Visible = True;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
end-method;

method MGR_Chkpt2_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   
   &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
   
   &WorkCenterUI.MGR_Chkpt2(&rssubstep, &HeaderRec);
   
   &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   
end-method;

method MGR_Chkpt3
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Checkpoint, manager can update, and comments not shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then */
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub3UpdateandShare.Visible = True;
         &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            If &GBL_TP_same_focus Then
            Else
               &rowChkSub3UpdateandShare.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowChkSub3ReviewwithEmployee.Visible = True;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub3View.Visible = True;
         &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      Else
         &rowChkSub3UpdateandShare.Visible = True;
         &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   /* Check points, manager can update and manager comments are shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then /*And
            &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then */
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub3UpdateandShare.Visible = True;
         &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
            &rowChkSub3UpdateandShare.Style = "PSGRIDROWSELECTED";
         Else
         End-If;
         
         &rowChkSub3ReviewwithEmployee.Visible = True;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub3ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      Else
         &rowChkSub3ReviewwithEmployee.Visible = True;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
end-method;

method MGR_Chkpt3_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   
   &WorkCenterUI.MGR_Chkpt3(&rssubstep, &HeaderRec);
   
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   
end-method;

method MGR_Chkpt4
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Checkpoint, manager can update, and comments not shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub4UpdateandShare.Visible = True;
         &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            If &GBL_TP_same_focus Then
            Else
               &rowChkSub4UpdateandShare.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowChkSub4ReviewwithEmployee.Visible = True;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub4View.Visible = True;
         &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      Else
         &rowChkSub4UpdateandShare.Visible = True;
         &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   
   /* Check points, manager can update and manager comments are shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub4UpdateandShare.Visible = True;
         &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
            &rowChkSub4UpdateandShare.Style = "PSGRIDROWSELECTED";
         Else
         End-If;
         &rowChkSub4ReviewwithEmployee.Visible = True;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub4ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         
      Else
         &rowChkSub4ReviewwithEmployee.Visible = True;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
end-method;

method MGR_Chkpt4_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   
   &WorkCenterUI.MGR_Chkpt4(&rssubstep, &HeaderRec);
   
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   
end-method;

method MGR_Chkpt5
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Checkpoint, manager can update, and comments not shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then */
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub5UpdateandShare.Visible = True;
         &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            If &GBL_TP_same_focus Then
            Else
               &rowChkSub5UpdateandShare.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowChkSub5ReviewwithEmployee.Visible = True;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         rem  &rowChkSub5View.Visible = True;
         rem  &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      Else
         &rowChkSub5UpdateandShare.Visible = True;
         &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   /* Check points, manager can update and manager comments are shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub5UpdateandShare.Visible = True;
         &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
            &rowChkSub5UpdateandShare.Style = "PSGRIDROWSELECTED";
         Else
         End-If;
         &rowChkSub5ReviewwithEmployee.Visible = True;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub5ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         rem  &rowChkSub5View.Visible = True;
         rem  &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      Else
         &rowChkSub5ReviewwithEmployee.Visible = True;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
end-method;

method MGR_Chkpt5_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   
   &WorkCenterUI.MGR_Chkpt5(&rssubstep, &HeaderRec);
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   
end-method;

method MGR_Chkpt6
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Checkpoint, manager can update, and comments not shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub6UpdateandShare.Visible = True;
         &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            
            If &GBL_TP_same_focus Then
            Else
               &rowChkSub6UpdateandShare.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowChkSub6ReviewwithEmployee.Visible = True;
         &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub6View.Visible = True;
         &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      Else
         &rowChkSub6UpdateandShare.Visible = True;
         &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   /* Check points, manager can update and manager comments are shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub6UpdateandShare.Visible = True;
         &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
            &rowChkSub6UpdateandShare.Style = "PSGRIDROWSELECTED";
         Else
         End-If;
         &rowChkSub6ReviewwithEmployee.Visible = True;
         &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub6ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      Else
         &rowChkSub6ReviewwithEmployee.Visible = True;
         &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If
   End-If;
end-method;

method MGR_Chkpt6_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   &WorkCenterUI.MGR_Chkpt6(&rssubstep, &HeaderRec);
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   
end-method;

method MGR_Chkpt7
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Checkpoint, manager can update, and comments not shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub7UpdateandShare.Visible = True;
         &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            If &GBL_TP_same_focus Then
            Else
               &rowChkSub7UpdateandShare.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowChkSub7ReviewwithEmployee.Visible = True;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      Else
         &rowChkSub7UpdateandShare.Visible = True;
         &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   
   /* Check points, manager can update and manager comments are shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub7UpdateandShare.Visible = True;
         &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
            &rowChkSub7UpdateandShare.Style = "PSGRIDROWSELECTED";
         Else
         End-If;
         &rowChkSub7ReviewwithEmployee.Visible = True;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub7ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      Else
         &rowChkSub7ReviewwithEmployee.Visible = True;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
end-method;

method MGR_Chkpt7_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   
   &WorkCenterUI.MGR_Chkpt7(&rssubstep, &HeaderRec);
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   
end-method;

method MGR_Chkpt8
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Checkpoint, manager can update, and comments not shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub8UpdateandShare.Visible = True;
         &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            If &GBL_TP_same_focus Then
            Else
               &rowChkSub8UpdateandShare.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowChkSub8ReviewwithEmployee.Visible = True;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      Else
         &rowChkSub8UpdateandShare.Visible = True;
         
         &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
      
   End-If;
   /* Check points, manager can update and manager comments are shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub8UpdateandShare.Visible = True;
         &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
            &rowChkSub8UpdateandShare.Style = "PSGRIDROWSELECTED";
         Else
         End-If;
         &rowChkSub8ReviewwithEmployee.Visible = True;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub8ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      Else
         &rowChkSub8ReviewwithEmployee.Visible = True;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
end-method;

method MGR_Chkpt8_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   
   &WorkCenterUI.MGR_Chkpt8(&rssubstep, &HeaderRec);
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   
end-method;

method MGR_Chkpt9
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Checkpoint, manager can update, and comments not shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then /* And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then */
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub9UpdateandShare.Visible = True;
         &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            
            If &GBL_TP_same_focus Then
            Else
               &rowChkSub9UpdateandShare.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowChkSub9ReviewwithEmployee.Visible = True;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         
      Else
         &rowChkSub9UpdateandShare.Visible = True;
         &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   /* Check points, manager can update and manager comments are shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub9UpdateandShare.Visible = True;
         &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
            &rowChkSub9UpdateandShare.Style = "PSGRIDROWSELECTED";
         Else
         End-If;
         &rowChkSub9ReviewwithEmployee.Visible = True;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub9ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      Else
         &rowChkSub9ReviewwithEmployee.Visible = True;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
end-method;

method MGR_Chkpt9_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   
   &WorkCenterUI.MGR_Chkpt9(&rssubstep, &HeaderRec);
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   
end-method;

method MGR_Chkpt10
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Checkpoint, manager can update, and comments not shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub10UpdateandShare.Visible = True;
         &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            
            If &GBL_TP_same_focus Then
            Else
               &rowChkSub10UpdateandShare.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowChkSub10ReviewwithEmployee.Visible = True;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      Else
         &rowChkSub10UpdateandShare.Visible = True;
         &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   
   /* Check points, manager can update and manager comments are shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then /* And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then */
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub10UpdateandShare.Visible = True;
         &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
            &rowChkSub10UpdateandShare.Style = "PSGRIDROWSELECTED";
         Else
         End-If;
         &rowChkSub10ReviewwithEmployee.Visible = True;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub10ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      Else
         &rowChkSub10ReviewwithEmployee.Visible = True;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
end-method;

method MGR_Chkpt10_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   
   &WorkCenterUI.MGR_Chkpt10(&rssubstep, &HeaderRec);
   &rowChkSub11UpdateandShare.Visible = True;
   &rowChkSub11ReviewwithEmployee.Visible = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
end-method;


method MGR_Chkpt11
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Checkpoint, manager can update, and comments not shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub11UpdateandShare.Visible = True;
         &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            If &GBL_TP_same_focus Then
            Else
               &rowChkSub11UpdateandShare.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowChkSub11ReviewwithEmployee.Visible = True;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      Else
         &rowChkSub11UpdateandShare.Visible = True;
         &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   /* Check points, manager can update and manager comments are shared */
   If (&HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Or
         &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B") And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then /*And
         &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
      If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
         &rowChkSub11UpdateandShare.Visible = True;
         &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
            &rowChkSub11UpdateandShare.Style = "PSGRIDROWSELECTED";
         Else
         End-If;
         &rowChkSub11ReviewwithEmployee.Visible = True;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub11ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      Else
         &rowChkSub11ReviewwithEmployee.Visible = True;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
end-method;

method MGR_Chkpt11_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   
   &WorkCenterUI.MGR_Chkpt11(&rssubstep, &HeaderRec);
   
end-method;

method EE_Chkpt1
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Track Progress is In Progress, and sub-status is Check point 1*/
   /* EE can update,EE comment switch is "NO" */
   
   
   /* Manager Shared Comment is "NO" */
   
   
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub1UpdateandShare.Visible = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub1UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /* Update*/
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub1ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub1View.Visible = True;
      &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      rem  Else
    rem &rowChkSub1View.Visible = True;
      rem  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
   End-If;
   
   /* Check points:  EE can update, EE comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      &rowChkSub1UpdateandShare.Visible = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub1UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      /* Update */
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      
      &rowChkSub1ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub1ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
      rem  &rowChkSub1View.Visible = True;
      rem &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* Check Point, EE can update, EE comment switch is "Y" and EE Comments Shared is "NO"  */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub1UpdateandShare.Visible = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub1UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      &rowChkSub1ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub1View.Visible = True;
      &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   End-If;
   
   /* EE can update, EE comments switch is "Yes", EE Comments shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "Y" Then
      
      
      &rowChkSub1UpdateandShare.Visible = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub1UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      &rowChkSub1ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub1ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
      
   End-If;
   
   
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub1UpdateandShare.Visible = False;
      &rowChkSub1ReviewwithEmployee.Visible = True;
      
      /* EE: Review with manager comments */
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub1ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         
      End-If;
      
      
   End-If;
   
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub1UpdateandShare.Visible = False;
      &rowChkSub1ReviewwithEmployee.Visible = True;
      
      /* EE: Review with manager comments */
      &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub1ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         
      End-If;
      
      
   End-If;
   
   
end-method;

method EE_Chkpt1_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   &WorkCenterUI.EE_Chkpt1(&rssubstep, &HeaderRec);
   
   &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   
   
   &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
end-method;

method EE_Chkpt2
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Track Progress is In Progress, and sub-status is Check point 1*/
   /* EE can update,EE comment switch is "NO" */
   /* Manager Shared Comment is "NO" */
   
   &rowChkSub2UpdateandShare.Visible = False;
   &rowChkSub2ReviewwithEmployee.Visible = False;
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub2UpdateandShare.Visible = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub2UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /* Update */
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      
      &rowChkSub2ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      rem   &rowChkSub2View.Visible = True;
      rem   &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   End-If;
   
   /* Check points:  EE can update, EE comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub2UpdateandShare.Visible = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
      
      If &GBL_TP_same_focus Then
         &rowChkSub2UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      /* Update */
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub2ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub2ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
      rem &rowChkSub2View.Visible = True;
      rem &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* Check Point, EE can update, EE comment switch is "Y" and EE Comments Shared is "NO"  */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub2UpdateandShare.Visible = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         &rowChkSub2UpdateandShare.Style = "PSGRIDROWSELECTED";
      End-If;
      &rowChkSub2ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      rem  &rowChkSub2View.Visible = True;
      rem  &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   End-If;
   
   /* EE can update, EE comments switch is "Yes", EE Comments shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "Y" Then
      
      
      &rowChkSub2UpdateandShare.Visible = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub2UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      &rowChkSub2ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub2ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
      
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      
      
      
      &rowChkSub2UpdateandShare.Visible = False;
      &rowChkSub2ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            
            &rowChkSub2ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         
      End-If;
   End-If;
   
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      
      
      &rowChkSub2UpdateandShare.Visible = False;
      &rowChkSub2ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            
            &rowChkSub2ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         
      End-If;
   End-If;
end-method;


method EE_Chkpt2_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   
   &WorkCenterUI.EE_Chkpt2(&rssubstep, &HeaderRec);
   
   
   &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   
   
   &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
end-method;

method EE_Chkpt3
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Track Progress is In Progress, and sub-status is Check point 1*/
   /* EE can update,EE comment switch is "NO" */
   /* Manager Shared Comment is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub3UpdateandShare.Visible = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub3UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /* Update */
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub3ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub3View.Visible = True;
      &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   End-If;
   
   /* Check points:  EE can update, EE comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub3UpdateandShare.Visible = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub3UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      
      /* Update */
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub3ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub3ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
      rem  &rowChkSub3View.Visible = True;
      rem  &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* Check Point, EE can update, EE comment switch is "Y" and EE Comments Shared is "NO"  */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub3UpdateandShare.Visible = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub3UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /*Update */
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub3ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      rem  &rowChkSub3View.Visible = True;
      rem  &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   End-If;
   
   /* EE can update, EE comments switch is "Yes", EE Comments shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "Y" Then
      
      
      &rowChkSub3UpdateandShare.Visible = True;
      
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub3ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub3ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub3UpdateandShare.Visible = False;
      &rowChkSub3ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub3ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         
      End-If;
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub3UpdateandShare.Visible = False;
      &rowChkSub3ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub3ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         
      End-If;
   End-If;
end-method;


method EE_Chkpt3_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   &WorkCenterUI.EE_Chkpt3(&rssubstep, &HeaderRec);
   
   
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   
   &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
end-method;

method EE_Chkpt4
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Track Progress is In Progress, and sub-status is Check point 1*/
   /* EE can update,EE comment switch is "NO" */
   /* Manager Shared Comment is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub4UpdateandShare.Visible = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub4UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /* Update */
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub4ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* Check points:  EE can update, EE comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub4UpdateandShare.Visible = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub4UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      /*Update*/
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub4ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub4ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
      
   End-If;
   
   /* Check Point, EE can update, EE comment switch is "Y" and EE Comments Shared is "NO"  */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub4UpdateandShare.Visible = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub4UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      &rowChkSub4ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* EE can update, EE comments switch is "Yes", EE Comments shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub4UpdateandShare.Visible = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub4UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      &rowChkSub4ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub4ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub4UpdateandShare.Visible = False;
      &rowChkSub4ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub4ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         
      End-If;
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      &rowChkSub4UpdateandShare.Visible = False;
      &rowChkSub4ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub4ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         
      End-If;
   End-If;
end-method;


method EE_Chkpt4_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   &WorkCenterUI.EE_Chkpt4(&rssubstep, &HeaderRec);
   
   
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   
end-method;

method EE_Chkpt5
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Track Progress is In Progress, and sub-status is Check point 1*/
   /* EE can update,EE comment switch is "NO" */
   /* Manager Shared Comment is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub5UpdateandShare.Visible = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub5UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /*Update */
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub5ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* Check points:  EE can update, EE comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub5UpdateandShare.Visible = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
      If &GBL_TP_same_focus Then
         &rowChkSub5UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      /*Update*/
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub5ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub5ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   /* Check Point, EE can update, EE comment switch is "Y" and EE Comments Shared is "NO"  */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub5UpdateandShare.Visible = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub5UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      &rowChkSub5ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* EE can update, EE comments switch is "Yes", EE Comments shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub5UpdateandShare.Visible = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub5UpdateandShare.Style = "PSGRIDROWSELECTED";
         
      Else
      End-If;
      &rowChkSub5ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub5ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub5UpdateandShare.Visible = False;
      &rowChkSub5ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub5ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         
      End-If;
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub5UpdateandShare.Visible = False;
      &rowChkSub5ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub5ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         
      End-If;
   End-If;
end-method;


method EE_Chkpt5_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   &WorkCenterUI.EE_Chkpt5(&rssubstep, &HeaderRec);
   
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   
   &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   
   
end-method;

method EE_Chkpt6
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Track Progress is In Progress, and sub-status is Check point 1*/
   /* EE can update,EE comment switch is "NO" */
   /* Manager Shared Comment is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub6UpdateandShare.Visible = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub6UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /*Update*/
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub6ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* Check points:  EE can update, EE comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub6UpdateandShare.Visible = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub6UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      /*Update */
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      
      &rowChkSub6ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub6ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   /* Check Point, EE can update, EE comment switch is "Y" and EE Comments Shared is "NO"  */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub6UpdateandShare.Visible = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub6UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      &rowChkSub6ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* EE can update, EE comments switch is "Yes", EE Comments shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub6UpdateandShare.Visible = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub6UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      &rowChkSub6ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub6ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub6UpdateandShare.Visible = False;
      &rowChkSub6ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         &rowChkSub6ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub6UpdateandShare.Visible = False;
      &rowChkSub6ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         &rowChkSub6ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
end-method;


method EE_Chkpt6_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   &WorkCenterUI.EE_Chkpt6(&rssubstep, &HeaderRec);
   
   
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
end-method;

method EE_Chkpt7
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Track Progress is In Progress, and sub-status is Check point 1*/
   /* EE can update,EE comment switch is "NO" */
   /* Manager Shared Comment is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub7UpdateandShare.Visible = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub7UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /*Update */
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub7ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* Check points:  EE can update, EE comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub7UpdateandShare.Visible = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub7UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      /*Update*/
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      
      &rowChkSub7ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub7ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   /* Check Point, EE can update, EE comment switch is "Y" and EE Comments Shared is "NO"  */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub7UpdateandShare.Visible = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         &rowChkSub7ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
      &rowChkSub7ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* EE can update, EE comments switch is "Yes", EE Comments shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "Y" Then
      
      
      &rowChkSub7UpdateandShare.Visible = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub7UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      &rowChkSub7ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub7ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub7UpdateandShare.Visible = False;
      &rowChkSub7ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub7ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub7UpdateandShare.Visible = False;
      &rowChkSub7ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub7ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
   End-If;
   
end-method;


method EE_Chkpt7_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   &WorkCenterUI.EE_Chkpt7(&rssubstep, &HeaderRec);
   
   
   
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   
   
   &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
end-method;

method EE_Chkpt8
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Track Progress is In Progress, and sub-status is Check point 1*/
   /* EE can update,EE comment switch is "NO" */
   /* Manager Shared Comment is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub8UpdateandShare.Visible = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub8UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /*Update*/
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      
      &rowChkSub8ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* Check points:  EE can update, EE comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub8UpdateandShare.Visible = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub8UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      /*Update */
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub8ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub8ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   /* Check Point, EE can update, EE comment switch is "Y" and EE Comments Shared is "NO"  */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub8UpdateandShare.Visible = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         &rowChkSub8UpdateandShare.Style = "PSGRIDROWSELECTED";
      End-If;
      &rowChkSub8ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* EE can update, EE comments switch is "Yes", EE Comments shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub8UpdateandShare.Visible = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub8UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      &rowChkSub8ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub8ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub8UpdateandShare.Visible = False;
      &rowChkSub8ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub8ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         &rowChkSub8View.Visible = True;
         &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub8UpdateandShare.Visible = False;
      &rowChkSub8ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub8ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
         &rowChkSub8View.Visible = True;
         &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      End-If;
   End-If;
   
end-method;


method EE_Chkpt8_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   &WorkCenterUI.EE_Chkpt8(&rssubstep, &HeaderRec);
   
   
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   
   
   &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
end-method;

method EE_Chkpt9
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Track Progress is In Progress, and sub-status is Check point 1*/
   /* EE can update,EE comment switch is "NO" */
   /* Manager Shared Comment is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub9UpdateandShare.Visible = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub9UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /*Update*/
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub9ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* Check points:  EE can update, EE comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub9UpdateandShare.Visible = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub9UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      /*Update*/
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub9ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub9ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   /* Check Point, EE can update, EE comment switch is "Y" and EE Comments Shared is "NO"  */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "N" Then
      &rowChkSub9UpdateandShare.Visible = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub9UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      &rowChkSub9ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   End-If;
   
   /* EE can update, EE comments switch is "Yes", EE Comments shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub9UpdateandShare.Visible = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub9UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      &rowChkSub9ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub9ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
      
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub9UpdateandShare.Visible = False;
      &rowChkSub9ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub9ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
   End-If;
   
   
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      &rowChkSub9UpdateandShare.Visible = False;
      &rowChkSub9ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub9ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
   End-If;
   
end-method;


method EE_Chkpt9_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   &WorkCenterUI.EE_Chkpt9(&rssubstep, &HeaderRec);
   
   
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   
   &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
end-method;

method EE_Chkpt10
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Track Progress is In Progress, and sub-status is Check point 1*/
   /* EE can update,EE comment switch is "NO" */
   /* Manager Shared Comment is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub10UpdateandShare.Visible = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub10UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /*Update*/
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub10ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub10View.Visible = True;
      &rowChkSub10View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   End-If;
   
   /* Check points:  EE can update, EE comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub10UpdateandShare.Visible = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub10UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      /*Update */
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      
      &rowChkSub10ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub10ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   /* Check Point, EE can update, EE comment switch is "Y" and EE Comments Shared is "NO"  */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub10UpdateandShare.Visible = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub10UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      &rowChkSub10ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* EE can update, EE comments switch is "Yes", EE Comments shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub10UpdateandShare.Visible = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub10UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      &rowChkSub10ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub10ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub10UpdateandShare.Visible = False;
      &rowChkSub10ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub10ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
   End-If;
   
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub10UpdateandShare.Visible = False;
      &rowChkSub10ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub10ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
   End-If;
   
end-method;


method EE_Chkpt10_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   &WorkCenterUI.EE_Chkpt10(&rssubstep, &HeaderRec);
   
   
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
   &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
end-method;

method EE_Chkpt11
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   /* Track Progress is In Progress, and sub-status is Check point 1*/
   /* EE can update,EE comment switch is "NO" */
   /* Manager Shared Comment is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      &rowChkSub11UpdateandShare.Visible = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub11UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      /*Update*/
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub11ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* Check points:  EE can update, EE comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub11UpdateandShare.Visible = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
      If &GBL_TP_same_focus Then
         &rowChkSub11UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      /*Update*/
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub11ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
      Else
         &rowChkSub11ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
      
   End-If;
   
   /* Check Point, EE can update, EE comment switch is "Y" and EE Comments Shared is "NO"  */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub11UpdateandShare.Visible = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
            &HeaderRec.EP_EST_STATUS.Value = "NA" Then
         If &GBL_TP_same_focus Then
         Else
            &rowChkSub11UpdateandShare.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
      &rowChkSub11ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   End-If;
   
   /* EE can update, EE comments switch is "Yes", EE Comments shared is "Yes" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "Y" And
         &HeaderRec.EP_EE_CMNT_SHARED.Value = "Y" Then
      &rowChkSub11UpdateandShare.Visible = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      If &GBL_TP_same_focus Then
         &rowChkSub11UpdateandShare.Style = "PSGRIDROWSELECTED";
      Else
      End-If;
      &rowChkSub11ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
      
      If &GBL_TP_same_focus Then
         
      Else
         &rowChkSub11ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
      End-If;
   End-If;
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "NO" */
   
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
      
      &rowChkSub11UpdateandShare.Visible = False;
      &rowChkSub11ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub11ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
   End-If;
   
   
   /* Checkpoints: EE can't update, EE Comments switch is off, Manager Comments Shared is "Yes" */
   If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
         &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
         &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y" Then
      
      &rowChkSub11UpdateandShare.Visible = False;
      &rowChkSub11ReviewwithEmployee.Visible = True;
      /* EE: Review with manager comments */
      &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
         
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      Else
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &HeaderRec.EP_EST_STATUS.Value = "CO" Or
               &HeaderRec.EP_EST_STATUS.Value = "NA" Then
            &rowChkSub11ReviewwithEmployee.Style = "PSGRIDROWSELECTED";
         End-If;
      End-If;
   End-If;
end-method;


method EE_Chkpt11_UI
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   &WorkCenterUI.EE_Chkpt11(&rssubstep, &HeaderRec);
   
   
   
end-method;

method CHKPT_Substeps
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record, +/
   /+ &ECstepexist as Boolean +/
   
   Local number &ChkPtNbr;
   Local date &ChkptDueDate;
   Local string &DataSaved;
   Local number &FetchedRows = 0;
   Local SQL &ChkptSql;
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   /* Hide all sub-steps for 11 check point steps */
   /* dont add logic here to display the reopen link because on Activate, it is always hidden */
   
   &rowChkSub1UpdateandShare.Visible = False;
   &rowChkSub1ReviewwithEmployee.Visible = False;
   &rowChkSub1View.Visible = False;
   &rowChkSub1Reopen.Visible = False;
   
   &rowChkSub2UpdateandShare.Visible = False;
   &rowChkSub2ReviewwithEmployee.Visible = False;
   &rowChkSub2View.Visible = False;
   &rowChkSub2Reopen.Visible = False;
   
   &rowChkSub3UpdateandShare.Visible = False;
   &rowChkSub3ReviewwithEmployee.Visible = False;
   &rowChkSub3View.Visible = False;
   &rowChkSub3Reopen.Visible = False;
   
   &rowChkSub4UpdateandShare.Visible = False;
   &rowChkSub4ReviewwithEmployee.Visible = False;
   &rowChkSub4View.Visible = False;
   &rowChkSub4Reopen.Visible = False;
   
   &rowChkSub5UpdateandShare.Visible = False;
   &rowChkSub5ReviewwithEmployee.Visible = False;
   &rowChkSub5View.Visible = False;
   &rowChkSub5Reopen.Visible = False;
   
   &rowChkSub6UpdateandShare.Visible = False;
   &rowChkSub6ReviewwithEmployee.Visible = False;
   &rowChkSub6View.Visible = False;
   &rowChkSub6Reopen.Visible = False;
   
   &rowChkSub7UpdateandShare.Visible = False;
   &rowChkSub7ReviewwithEmployee.Visible = False;
   &rowChkSub7View.Visible = False;
   &rowChkSub7Reopen.Visible = False;
   
   &rowChkSub8UpdateandShare.Visible = False;
   &rowChkSub8ReviewwithEmployee.Visible = False;
   &rowChkSub8View.Visible = False;
   &rowChkSub8Reopen.Visible = False;
   
   &rowChkSub9UpdateandShare.Visible = False;
   &rowChkSub9ReviewwithEmployee.Visible = False;
   &rowChkSub9View.Visible = False;
   &rowChkSub9Reopen.Visible = False;
   
   &rowChkSub10UpdateandShare.Visible = False;
   &rowChkSub10ReviewwithEmployee.Visible = False;
   &rowChkSub10View.Visible = False;
   &rowChkSub10Reopen.Visible = False;
   
   &rowChkSub11UpdateandShare.Visible = False;
   &rowChkSub11ReviewwithEmployee.Visible = False;
   &rowChkSub11View.Visible = False;
   &rowChkSub11Reopen.Visible = False;
   
   Evaluate &HeaderRec.EP_TRKPROG_STATUS.Value
   When = "NS"
   When = "IP"
      
      /*************************************/
      /*  Track Progress is In Progress    */
      /*************************************/
      Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
      When = "E" /* Employee */
         /*************************************/
         /*  Employee -  In Progress          */
         /*************************************/
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         Evaluate &HeaderRec.EP_TP_NBR_CHECKPTS.Value
         When = 1
            &WorkCenterUI.EE_Chkpt1_UI(&rssubstep, &HeaderRec);
            
            Break;
            
         When = 2
            /* Show check point 1 substeps */
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &WorkCenterUI.EE_Chkpt2(&rssubstep, &HeaderRec);
            /* if TP Sub Status is "1", repeat Checkpoint 1 logic */
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.EE_Chkpt1_UI(&rssubstep, &HeaderRec);
               Break;
               
            When = "2"
               &WorkCenterUI.EE_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
               
            End-Evaluate;
            
         When = 3
            /* Show check point 1 -2 substeps */
            
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &WorkCenterUI.EE_Chkpt3(&rssubstep, &HeaderRec);
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.EE_Chkpt1_UI(&rssubstep, &HeaderRec);
               Break;
               
            When = "2"
               &WorkCenterUI.EE_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
            When = "3"
               &WorkCenterUI.EE_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               Break;
               
            End-Evaluate;
         When = 4
            /* Show check point 1 -3 substeps */
            
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &WorkCenterUI.EE_Chkpt4(&rssubstep, &HeaderRec);
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.EE_Chkpt1_UI(&rssubstep, &HeaderRec);
               Break;
               
            When = "2"
               &WorkCenterUI.EE_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
               
            When = "3"
               &WorkCenterUI.EE_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               Break;
               
            When = "4"
               &WorkCenterUI.EE_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
               
            End-Evaluate;
         When = 5
            /* Show check point 1 -4 substeps */
            
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &WorkCenterUI.EE_Chkpt5(&rssubstep, &HeaderRec);
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.EE_Chkpt1_UI(&rssubstep, &HeaderRec);
               
               Break;
               
            When = "2"
               &WorkCenterUI.EE_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
            When = "3"
               &WorkCenterUI.EE_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               Break;
            When = "4"
               &WorkCenterUI.EE_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
            When = "5"
               &WorkCenterUI.EE_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               Break;
            End-Evaluate;
            
         When = 6
            /* Show check point 1 -5 substeps */
            
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            &WorkCenterUI.EE_Chkpt6(&rssubstep, &HeaderRec);
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.EE_Chkpt1_UI(&rssubstep, &HeaderRec);
               
               Break;
               
            When = "2"
               &WorkCenterUI.EE_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               
               Break;
            When = "3"
               &WorkCenterUI.EE_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               Break;
            When = "4"
               &WorkCenterUI.EE_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
               
            When = "5"
               &WorkCenterUI.EE_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               Break;
               
            When = "6"
               &WorkCenterUI.EE_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               Break;
            End-Evaluate;
            Break;
            
         When = 7
            /* Show check point 1 -6 substeps */
            
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            &rowChkSub6UpdateandShare.Visible = True;
            &rowChkSub6ReviewwithEmployee.Visible = True;
            
            &WorkCenterUI.EE_Chkpt7(&rssubstep, &HeaderRec);
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.EE_Chkpt1_UI(&rssubstep, &HeaderRec);
               
               Break;
               
            When = "2"
               &WorkCenterUI.EE_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
            When = "3"
               &WorkCenterUI.EE_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               Break;
               
            When = "4"
               &WorkCenterUI.EE_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
               
            When = "5"
               &WorkCenterUI.EE_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               Break;
            When = "6"
               &WorkCenterUI.EE_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               Break;
               
            When = "7"
               &WorkCenterUI.EE_Chkpt7_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               Break;
               
            End-Evaluate;
            
         When = 8
            /* Show check point 1 -7 substeps */
            
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            &rowChkSub6UpdateandShare.Visible = True;
            &rowChkSub6ReviewwithEmployee.Visible = True;
            
            &rowChkSub7UpdateandShare.Visible = True;
            &rowChkSub7ReviewwithEmployee.Visible = True;
            &WorkCenterUI.EE_Chkpt8(&rssubstep, &HeaderRec);
            
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.EE_Chkpt1_UI(&rssubstep, &HeaderRec);
               
               Break;
            When = "2"
               &WorkCenterUI.EE_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
            When = "3"
               &WorkCenterUI.EE_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               Break;
               
            When = "4"
               &WorkCenterUI.EE_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
               
            When = "5"
               &WorkCenterUI.EE_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               
               Break;
            When = "6"
               &WorkCenterUI.EE_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               
               Break;
            When = "7"
               &WorkCenterUI.EE_Chkpt7_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               
               Break;
            When = "8"
               &WorkCenterUI.EE_Chkpt8_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               
               Break;
               
            End-Evaluate;
         When = 9
            /* Show check point 1 -8 substeps */
            
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            &rowChkSub6UpdateandShare.Visible = True;
            &rowChkSub6ReviewwithEmployee.Visible = True;
            
            &rowChkSub7UpdateandShare.Visible = True;
            &rowChkSub7ReviewwithEmployee.Visible = True;
            
            &rowChkSub8UpdateandShare.Visible = True;
            &rowChkSub8ReviewwithEmployee.Visible = True;
            
            &WorkCenterUI.EE_Chkpt9(&rssubstep, &HeaderRec);
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.EE_Chkpt1_UI(&rssubstep, &HeaderRec);
               
               Break;
               
            When = "2"
               &WorkCenterUI.EE_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
               
            When = "3"
               &WorkCenterUI.EE_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               Break;
               
            When = "4"
               &WorkCenterUI.EE_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
               
            When = "5"
               &WorkCenterUI.EE_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               Break;
               
            When = "6"
               &WorkCenterUI.EE_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               Break;
               
            When = "7"
               &WorkCenterUI.EE_Chkpt7_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               
               Break;
               
            When = "8"
               &WorkCenterUI.EE_Chkpt8_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               
               Break;
            When = "9"
               &WorkCenterUI.EE_Chkpt9_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               
               Break;
               
            End-Evaluate;
            Break;
            
         When = 10
            /* Show check point 1 -9 substeps */
            
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            &rowChkSub6UpdateandShare.Visible = True;
            &rowChkSub6ReviewwithEmployee.Visible = True;
            
            &rowChkSub7UpdateandShare.Visible = True;
            &rowChkSub7ReviewwithEmployee.Visible = True;
            
            &rowChkSub8UpdateandShare.Visible = True;
            &rowChkSub8ReviewwithEmployee.Visible = True;
            
            &rowChkSub9UpdateandShare.Visible = True;
            &rowChkSub9ReviewwithEmployee.Visible = True;
            &WorkCenterUI.EE_Chkpt10(&rssubstep, &HeaderRec);
            
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.EE_Chkpt1_UI(&rssubstep, &HeaderRec);
               
               Break;
               
            When = "2"
               &WorkCenterUI.EE_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
            When = "3"
               &WorkCenterUI.EE_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               
               Break;
               
            When = "4"
               &WorkCenterUI.EE_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               
               Break;
            When = "5"
               &WorkCenterUI.EE_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               
               Break;
            When = "6"
               &WorkCenterUI.EE_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               
               Break;
            When = "7"
               &WorkCenterUI.EE_Chkpt7_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               Break;
               
            When = "8"
               &WorkCenterUI.EE_Chkpt8_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               Break;
               
            When = "9"
               &WorkCenterUI.EE_Chkpt9_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               
               Break;
               
            When = "10"
               &WorkCenterUI.EE_Chkpt10_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               &rowChkSub9UpdateandShare.Visible = False;
               &rowChkSub9ReviewwithEmployee.Visible = False;
               
               Break;
            End-Evaluate;
            
            Break;
         When = 11
            /* Show check point 1 -10 substeps */
            
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            &rowChkSub6UpdateandShare.Visible = True;
            &rowChkSub6ReviewwithEmployee.Visible = True;
            
            &rowChkSub7UpdateandShare.Visible = True;
            &rowChkSub7ReviewwithEmployee.Visible = True;
            
            &rowChkSub8UpdateandShare.Visible = True;
            &rowChkSub8ReviewwithEmployee.Visible = True;
            
            &rowChkSub9UpdateandShare.Visible = True;
            &rowChkSub9ReviewwithEmployee.Visible = True;
            
            &rowChkSub10UpdateandShare.Visible = True;
            &rowChkSub10ReviewwithEmployee.Visible = True;
            
            &WorkCenterUI.EE_Chkpt11(&rssubstep, &HeaderRec);
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.EE_Chkpt1_UI(&rssubstep, &HeaderRec);
               
               Break;
            When = "2"
               &WorkCenterUI.EE_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
               
            When = "3"
               &WorkCenterUI.EE_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               Break;
            When = "4"
               &WorkCenterUI.EE_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
               
            When = "5"
               &WorkCenterUI.EE_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               Break;
            When = "6"
               &WorkCenterUI.EE_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               Break;
               
            When = "7"
               &WorkCenterUI.EE_Chkpt7_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               
               Break;
               
            When = "8"
               &WorkCenterUI.EE_Chkpt8_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               Break;
               
            When = "9"
               &WorkCenterUI.EE_Chkpt9_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               Break;
               
            When = "10"
               &WorkCenterUI.EE_Chkpt10_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               &rowChkSub9UpdateandShare.Visible = False;
               &rowChkSub9ReviewwithEmployee.Visible = False;
               Break;
            When = "11"
               &WorkCenterUI.EE_Chkpt11_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               &rowChkSub9UpdateandShare.Visible = False;
               &rowChkSub9ReviewwithEmployee.Visible = False;
               &rowChkSub10UpdateandShare.Visible = False;
               &rowChkSub10ReviewwithEmployee.Visible = False;
               Break;
               
            End-Evaluate;
            
            
         When-Other
            Break;
         End-Evaluate;
         
      When = "M"
         
         &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB3", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         Evaluate &HeaderRec.EP_TP_NBR_CHECKPTS.Value
         When = 1
            If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
               
               &rowChkSub1UpdateandShare.Visible = True;
               &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowChkSub1ReviewwithEmployee.Visible = True;
               &rowChkSub1ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
            End-If;
            &WorkCenterUI.MGR_Chkpt1_UI(&rssubstep, &HeaderRec);
            
            Break;
            
            
         When = 2
            /* Show check point 1 substeps */
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            /* Show next Check point sub-steps when cancel */
            If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
               &rowChkSub2UpdateandShare.Visible = True;
               &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowChkSub2ReviewwithEmployee.Visible = True;
               &rowChkSub2ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            End-If;
            &WorkCenterUI.MGR_Chkpt2(&rssubstep, &HeaderRec);
            
            /* if TP Sub Status is "1", repeat Checkpoint 1 logic */
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.MGR_Chkpt1_UI(&rssubstep, &HeaderRec);
               Break;
               
               
            When = "2"
               &WorkCenterUI.MGR_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               
               Break;
            End-Evaluate;
            
         When = 3
            /* Show pervious check points substeps */
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            /* Show next Check point sub-steps when cancel */
            If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
               
               &rowChkSub3UpdateandShare.Visible = True;
               &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowChkSub3ReviewwithEmployee.Visible = True;
               &rowChkSub3ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            End-If;
            
            &WorkCenterUI.MGR_Chkpt3(&rssubstep, &HeaderRec);
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.MGR_Chkpt1_UI(&rssubstep, &HeaderRec);
               
               Break;
               
               /* if TP Sub Status is "2", repeat Checkpoint 2 logic */
            When = "2"
               &WorkCenterUI.MGR_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               
               Break;
               
               
            When = "3"
               &WorkCenterUI.MGR_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               
               Break;
               
            End-Evaluate;
            
         When = 4
            /* Show pervious check points substeps */
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
               &rowChkSub4UpdateandShare.Visible = True;
               &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowChkSub4ReviewwithEmployee.Visible = True;
               &rowChkSub4ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            End-If;
            &WorkCenterUI.MGR_Chkpt4(&rssubstep, &HeaderRec);
            /* if TP Sub Status is "1", repeat Checkpoint 1 logic */
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.MGR_Chkpt1_UI(&rssubstep, &HeaderRec);
               Break;
               
               /* if TP Sub Status is "2", repeat Checkpoint 2 logic */
            When = "2"
               &WorkCenterUI.MGR_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               
               Break;
               
               
               /*Only When Current Step is Checkpoint 3, mark all previous substeps completed */
            When = "3"
               &WorkCenterUI.MGR_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               
               Break;
            When = "4"
               &WorkCenterUI.MGR_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
               
               
            End-Evaluate;
         When = 5
            
            /* Show pervious check points substeps */
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
               &rowChkSub5UpdateandShare.Visible = True;
               &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowChkSub5ReviewwithEmployee.Visible = True;
               &rowChkSub5ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            End-If;
            &WorkCenterUI.MGR_Chkpt5(&rssubstep, &HeaderRec);
            /* if TP Sub Status is "1", repeat Checkpoint 1 logic */
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.MGR_Chkpt1_UI(&rssubstep, &HeaderRec);
               Break;
               
               
               /* if TP Sub Status is "2", repeat Checkpoint 2 logic */
            When = "2"
               &WorkCenterUI.MGR_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               
               Break;
               
               
               /*Only When Current Step is Checkpoint 3, mark all previous substeps completed */
            When = "3"
               &WorkCenterUI.MGR_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               
               Break;
               
            When = "4"
               &WorkCenterUI.MGR_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               
               Break;
               
            When = "5"
               &WorkCenterUI.MGR_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               
               
               Break;
               
               
            End-Evaluate;
         When = 6
            
            /* Show pervious check points substeps */
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            /* Show next Check point sub-steps when manager cancels */
            If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
               &rowChkSub6UpdateandShare.Visible = True;
               &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowChkSub6ReviewwithEmployee.Visible = True;
               &rowChkSub6ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            End-If;
            &WorkCenterUI.MGR_Chkpt6(&rssubstep, &HeaderRec);
            
            /* if TP Sub Status is "1", repeat Checkpoint 1 logic */
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.MGR_Chkpt1_UI(&rssubstep, &HeaderRec);
               Break;
               
               
               /* if TP Sub Status is "2", repeat Checkpoint 2 logic */
            When = "2"
               &WorkCenterUI.MGR_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
               
               
               /*Only When Current Step is Checkpoint 3, mark all previous substeps completed */
            When = "3"
               &WorkCenterUI.MGR_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               
               Break;
               
            When = "4"
               &WorkCenterUI.MGR_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               
               Break;
               
            When = "5"
               &WorkCenterUI.MGR_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               
               Break;
               
            When = "6"
               &WorkCenterUI.MGR_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               
               Break;
               
               
            End-Evaluate;
            
         When = 7
            /* Show pervious check points substeps */
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            &rowChkSub6UpdateandShare.Visible = True;
            &rowChkSub6ReviewwithEmployee.Visible = True;
            
            If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
               &rowChkSub7UpdateandShare.Visible = True;
               &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowChkSub7ReviewwithEmployee.Visible = True;
               &rowChkSub7ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            End-If;
            &WorkCenterUI.MGR_Chkpt7(&rssubstep, &HeaderRec);
            
            /* if TP Sub Status is "1", repeat Checkpoint 1 logic */
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.MGR_Chkpt1_UI(&rssubstep, &HeaderRec);
               Break;
               
               
               /* if TP Sub Status is "2", repeat Checkpoint 2 logic */
            When = "2"
               &WorkCenterUI.MGR_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
               
               
               /*Only When Current Step is Checkpoint 3, mark all previous substeps completed */
            When = "3"
               &WorkCenterUI.MGR_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               
               Break;
               
            When = "4"
               &WorkCenterUI.MGR_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
            When = "5"
               &WorkCenterUI.MGR_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               
               Break;
            When = "6"
               &WorkCenterUI.MGR_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               Break;
               
            When = "7"
               &WorkCenterUI.MGR_Chkpt7_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               Break;
               
               
               
            End-Evaluate;
         When = 8
            /* Show pervious check points substeps */
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            &rowChkSub6UpdateandShare.Visible = True;
            &rowChkSub6ReviewwithEmployee.Visible = True;
            
            &rowChkSub7UpdateandShare.Visible = True;
            &rowChkSub7ReviewwithEmployee.Visible = True;
            
            If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
               &rowChkSub8UpdateandShare.Visible = True;
               &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowChkSub8ReviewwithEmployee.Visible = True;
               &rowChkSub8ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            End-If;
            &WorkCenterUI.MGR_Chkpt8(&rssubstep, &HeaderRec);
            /* if TP Sub Status is "1", repeat Checkpoint 1 logic */
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.MGR_Chkpt1_UI(&rssubstep, &HeaderRec);
               Break;
               
               
               /* if TP Sub Status is "2", repeat Checkpoint 2 logic */
            When = "2"
               &WorkCenterUI.MGR_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
               
               
               /*Only When Current Step is Checkpoint 3, mark all previous substeps completed */
            When = "3"
               &WorkCenterUI.MGR_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               Break;
            When = "4"
               &WorkCenterUI.MGR_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
               
            When = "5"
               &WorkCenterUI.MGR_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               Break;
               
            When = "6"
               &WorkCenterUI.MGR_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               Break;
               
            When = "7"
               &WorkCenterUI.MGR_Chkpt7_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               Break;
               
            When = "8"
               &WorkCenterUI.MGR_Chkpt8_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               
               Break;
               
               
            End-Evaluate;
            
         When = 9
            /* Show pervious check points substeps */
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            &rowChkSub6UpdateandShare.Visible = True;
            &rowChkSub6ReviewwithEmployee.Visible = True;
            
            &rowChkSub7UpdateandShare.Visible = True;
            &rowChkSub7ReviewwithEmployee.Visible = True;
            
            &rowChkSub8UpdateandShare.Visible = True;
            &rowChkSub8ReviewwithEmployee.Visible = True;
            
            If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
               &rowChkSub9UpdateandShare.Visible = True;
               &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowChkSub9ReviewwithEmployee.Visible = True;
               &rowChkSub9ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            End-If;
            &WorkCenterUI.MGR_Chkpt9(&rssubstep, &HeaderRec);
            
            /* if TP Sub Status is "1", repeat Checkpoint 1 logic */
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.MGR_Chkpt1_UI(&rssubstep, &HeaderRec);
               Break;
               
               
               /* if TP Sub Status is "2", repeat Checkpoint 2 logic */
            When = "2"
               &WorkCenterUI.MGR_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
               
               
               /*Only When Current Step is Checkpoint 3, mark all previous substeps completed */
            When = "3"
               &WorkCenterUI.MGR_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               Break;
            When = "4"
               &WorkCenterUI.MGR_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
               
            When = "5"
               &WorkCenterUI.MGR_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               Break;
               
            When = "6"
               &WorkCenterUI.MGR_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               Break;
               
            When = "7"
               &WorkCenterUI.MGR_Chkpt7_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               Break;
               
            When = "8"
               &WorkCenterUI.MGR_Chkpt8_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               Break;
            When = "9"
               &WorkCenterUI.MGR_Chkpt9_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               
               Break;
               
               
            End-Evaluate;
         When = 10
            /* Show pervious check points substeps */
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            &rowChkSub6UpdateandShare.Visible = True;
            &rowChkSub6ReviewwithEmployee.Visible = True;
            
            &rowChkSub7UpdateandShare.Visible = True;
            &rowChkSub7ReviewwithEmployee.Visible = True;
            
            &rowChkSub8UpdateandShare.Visible = True;
            &rowChkSub8ReviewwithEmployee.Visible = True;
            
            &rowChkSub9UpdateandShare.Visible = True;
            &rowChkSub9ReviewwithEmployee.Visible = True;
            
            If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
               &rowChkSub10UpdateandShare.Visible = True;
               &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowChkSub10ReviewwithEmployee.Visible = True;
               &rowChkSub10ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            End-If;
            
            &WorkCenterUI.MGR_Chkpt10(&rssubstep, &HeaderRec);
            /* if TP Sub Status is "1", repeat Checkpoint 1 logic */
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &WorkCenterUI.MGR_Chkpt1_UI(&rssubstep, &HeaderRec);
               Break;
               
               /* if TP Sub Status is "2", repeat Checkpoint 2 logic */
            When = "2"
               &WorkCenterUI.MGR_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               Break;
               
               
            When = "3"
               &WorkCenterUI.MGR_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               
               Break;
            When = "4"
               &WorkCenterUI.MGR_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
               
            When = "5"
               &WorkCenterUI.MGR_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               
               Break;
               
            When = "6"
               &WorkCenterUI.MGR_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               Break;
               
            When = "7"
               &WorkCenterUI.MGR_Chkpt7_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               Break;
               
            When = "8"
               &WorkCenterUI.MGR_Chkpt8_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               Break;
               
            When = "9"
               &WorkCenterUI.MGR_Chkpt9_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               Break;
            When = "10"
               &WorkCenterUI.MGR_Chkpt10_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               &rowChkSub9UpdateandShare.Visible = False;
               &rowChkSub9ReviewwithEmployee.Visible = False;
               
               Break;
               
               
            End-Evaluate;
         When = 11
            
            /* Show pervious check points substeps */
            &rowChkSub1UpdateandShare.Visible = True;
            &rowChkSub1ReviewwithEmployee.Visible = True;
            
            &rowChkSub2UpdateandShare.Visible = True;
            &rowChkSub2ReviewwithEmployee.Visible = True;
            
            &rowChkSub3UpdateandShare.Visible = True;
            &rowChkSub3ReviewwithEmployee.Visible = True;
            
            
            &rowChkSub4UpdateandShare.Visible = True;
            &rowChkSub4ReviewwithEmployee.Visible = True;
            
            &rowChkSub5UpdateandShare.Visible = True;
            &rowChkSub5ReviewwithEmployee.Visible = True;
            
            &rowChkSub6UpdateandShare.Visible = True;
            &rowChkSub6ReviewwithEmployee.Visible = True;
            
            &rowChkSub7UpdateandShare.Visible = True;
            &rowChkSub7ReviewwithEmployee.Visible = True;
            
            &rowChkSub8UpdateandShare.Visible = True;
            &rowChkSub8ReviewwithEmployee.Visible = True;
            
            &rowChkSub9UpdateandShare.Visible = True;
            &rowChkSub9ReviewwithEmployee.Visible = True;
            
            &rowChkSub10UpdateandShare.Visible = True;
            &rowChkSub10ReviewwithEmployee.Visible = True;
            
            If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
               &rowChkSub11UpdateandShare.Visible = True;
               &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowChkSub11ReviewwithEmployee.Visible = True;
               &rowChkSub11ReviewwithEmployee.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            End-If;
            &WorkCenterUI.MGR_Chkpt11(&rssubstep, &HeaderRec);
            
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
               /* if TP Sub Status is "1", repeat Checkpoint 1 logic */
            When = "1"
               &WorkCenterUI.MGR_Chkpt1_UI(&rssubstep, &HeaderRec);
               
               Break;
               
               /* if TP Sub Status is "2", repeat Checkpoint 2 logic */
            When = "2"
               &WorkCenterUI.MGR_Chkpt2_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               
               Break;
               
               /*Only When Current Step is Checkpoint 3, mark all previous substeps completed */
            When = "3"
               &WorkCenterUI.MGR_Chkpt3_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               Break;
            When = "4"
               &WorkCenterUI.MGR_Chkpt4_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               Break;
               
            When = "5"
               &WorkCenterUI.MGR_Chkpt5_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               Break;
               
            When = "6"
               &WorkCenterUI.MGR_Chkpt6_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               Break;
               
            When = "7"
               &WorkCenterUI.MGR_Chkpt7_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               Break;
               
            When = "8"
               &WorkCenterUI.MGR_Chkpt8_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               Break;
               
            When = "9"
               &WorkCenterUI.MGR_Chkpt9_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               Break;
            When = "10"
               &WorkCenterUI.MGR_Chkpt10_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               &rowChkSub9UpdateandShare.Visible = False;
               &rowChkSub9ReviewwithEmployee.Visible = False;
               Break;
            When = "11"
               &WorkCenterUI.MGR_Chkpt11_UI(&rssubstep, &HeaderRec);
               &rowChkSub1UpdateandShare.Visible = False;
               &rowChkSub1ReviewwithEmployee.Visible = False;
               &rowChkSub2UpdateandShare.Visible = False;
               &rowChkSub2ReviewwithEmployee.Visible = False;
               &rowChkSub3UpdateandShare.Visible = False;
               &rowChkSub3ReviewwithEmployee.Visible = False;
               &rowChkSub4UpdateandShare.Visible = False;
               &rowChkSub4ReviewwithEmployee.Visible = False;
               &rowChkSub5UpdateandShare.Visible = False;
               &rowChkSub5ReviewwithEmployee.Visible = False;
               &rowChkSub6UpdateandShare.Visible = False;
               &rowChkSub6ReviewwithEmployee.Visible = False;
               &rowChkSub7UpdateandShare.Visible = False;
               &rowChkSub7ReviewwithEmployee.Visible = False;
               &rowChkSub8UpdateandShare.Visible = False;
               &rowChkSub8ReviewwithEmployee.Visible = False;
               &rowChkSub9UpdateandShare.Visible = False;
               &rowChkSub9ReviewwithEmployee.Visible = False;
               &rowChkSub10UpdateandShare.Visible = False;
               &rowChkSub10ReviewwithEmployee.Visible = False;
               Break;
               
               
               
            End-Evaluate;
            
         End-Evaluate;
      When = "H"
      When = "V"
         /* Admin, View-only role only can view check points */
         &rowChkSub1View.Visible = True;
         
         /* 20184553 - make sure EC is complete/NA before enabling the view link on chkpt 1 for admin */
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "1" And
               (&HeaderRec.EP_EST_STATUS.Value = "CO" Or
                  &HeaderRec.EP_EST_STATUS.Value = "NA") Then
            &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
         
         &rowChkSub2View.Visible = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "2" Then
            &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            
         End-If;
         &rowChkSub3View.Visible = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "3" Then
            &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
         &rowChkSub4View.Visible = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "4" Then
            &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
         &rowChkSub5View.Visible = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "5" Then
            &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
         &rowChkSub6View.Visible = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "6" Then
            &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
         &rowChkSub7View.Visible = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "7" Then
            &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
         &rowChkSub8View.Visible = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "8" Then
            &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
         &rowChkSub9View.Visible = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "9" Then
            &rowChkSub9View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowChkSub9View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
         &rowChkSub10View.Visible = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "10" Then
            &rowChkSub10View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowChkSub10View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
         &rowChkSub11View.Visible = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "11" Then
            &rowChkSub11View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowChkSub11View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
      When = "O"
         Break;
         
      End-Evaluate;
      
      
      
      /*Canceled*/
      If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
         Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
         When = "E"
         When = "H"
         When = "V"
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            &rowChkSub1View.Visible = True;
            &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub2ReviewwithEmployee.Visible = False;
            &rowChkSub2View.Visible = True;
            &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowChkSub3UpdateandShare.Visible = False;
            &rowChkSub3ReviewwithEmployee.Visible = False;
            &rowChkSub3View.Visible = True;
            &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowChkSub4UpdateandShare.Visible = False;
            &rowChkSub4ReviewwithEmployee.Visible = False;
            &rowChkSub4View.Visible = True;
            &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowChkSub5UpdateandShare.Visible = False;
            &rowChkSub5ReviewwithEmployee.Visible = False;
            &rowChkSub5View.Visible = True;
            &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowChkSub6UpdateandShare.Visible = False;
            &rowChkSub6ReviewwithEmployee.Visible = False;
            &rowChkSub6View.Visible = True;
            &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowChkSub7UpdateandShare.Visible = False;
            &rowChkSub7ReviewwithEmployee.Visible = False;
            &rowChkSub7View.Visible = True;
            &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowChkSub8UpdateandShare.Visible = False;
            &rowChkSub8ReviewwithEmployee.Visible = False;
            &rowChkSub8View.Visible = True;
            &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowChkSub9UpdateandShare.Visible = False;
            &rowChkSub9ReviewwithEmployee.Visible = False;
            &rowChkSub9View.Visible = True;
            &rowChkSub9View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowChkSub10UpdateandShare.Visible = False;
            &rowChkSub10ReviewwithEmployee.Visible = False;
            &rowChkSub10View.Visible = True;
            &rowChkSub10View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowChkSub11UpdateandShare.Visible = False;
            &rowChkSub11ReviewwithEmployee.Visible = False;
            &rowChkSub11View.Visible = True;
            &rowChkSub11View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               Break;
               
            When = "2"
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               Break;
               
            When = "3"
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               
               Break;
               
            When = "4"
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               Break;
               
            When = "5"
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               Break;
               
               
            When = "6"
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               Break;
               
            When = "7"
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               Break;
               
            When = "8"
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               Break;
               
            When = "9"
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub9View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               Break;
               
            When = "10"
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub9View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub10View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               Break;
               
            When = "11"
            When = "F"
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub9View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub10View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub11View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               
               Break;
            End-Evaluate;
         When = "M"
            Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
            When = "1"
               If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
               Else
                  &rowChkSub1UpdateandShare.Visible = False;
                  &rowChkSub1ReviewwithEmployee.Visible = False;
                  &rowChkSub1View.Visible = True;
                  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               End-If;
               Break;
               
            When = "2"
               If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
               Else
                  &rowChkSub1UpdateandShare.Visible = False;
                  &rowChkSub1ReviewwithEmployee.Visible = False;
                  &rowChkSub1View.Visible = True;
                  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub2UpdateandShare.Visible = False;
                  &rowChkSub2ReviewwithEmployee.Visible = False;
                  &rowChkSub2View.Visible = True;
                  &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               End-If;
               Break;
               
            When = "3"
               If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
               Else
                  &rowChkSub1UpdateandShare.Visible = False;
                  &rowChkSub1ReviewwithEmployee.Visible = False;
                  &rowChkSub1View.Visible = True;
                  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub2UpdateandShare.Visible = False;
                  &rowChkSub2ReviewwithEmployee.Visible = False;
                  &rowChkSub2View.Visible = True;
                  &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub3UpdateandShare.Visible = False;
                  &rowChkSub3ReviewwithEmployee.Visible = False;
                  &rowChkSub3View.Visible = True;
                  &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               End-If;
               Break;
            When = "4"
               If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
               Else
                  &rowChkSub1UpdateandShare.Visible = False;
                  &rowChkSub1ReviewwithEmployee.Visible = False;
                  &rowChkSub1View.Visible = True;
                  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub2UpdateandShare.Visible = False;
                  &rowChkSub2ReviewwithEmployee.Visible = False;
                  &rowChkSub2View.Visible = True;
                  &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub3UpdateandShare.Visible = False;
                  &rowChkSub3ReviewwithEmployee.Visible = False;
                  &rowChkSub3View.Visible = True;
                  &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub4UpdateandShare.Visible = False;
                  &rowChkSub4ReviewwithEmployee.Visible = False;
                  &rowChkSub4View.Visible = True;
                  &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               End-If;
               Break;
            When = "5"
               If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
               Else
                  &rowChkSub1UpdateandShare.Visible = False;
                  &rowChkSub1ReviewwithEmployee.Visible = False;
                  &rowChkSub1View.Visible = True;
                  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub2UpdateandShare.Visible = False;
                  &rowChkSub2ReviewwithEmployee.Visible = False;
                  &rowChkSub2View.Visible = True;
                  &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub3UpdateandShare.Visible = False;
                  &rowChkSub3ReviewwithEmployee.Visible = False;
                  &rowChkSub3View.Visible = True;
                  &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub4UpdateandShare.Visible = False;
                  &rowChkSub4ReviewwithEmployee.Visible = False;
                  &rowChkSub4View.Visible = True;
                  &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub5UpdateandShare.Visible = False;
                  &rowChkSub5ReviewwithEmployee.Visible = False;
                  &rowChkSub5View.Visible = True;
                  &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               End-If;
               Break;
            When = "6"
               If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
               Else
                  &rowChkSub1UpdateandShare.Visible = False;
                  &rowChkSub1ReviewwithEmployee.Visible = False;
                  &rowChkSub1View.Visible = True;
                  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub2UpdateandShare.Visible = False;
                  &rowChkSub2ReviewwithEmployee.Visible = False;
                  &rowChkSub2View.Visible = True;
                  &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub3UpdateandShare.Visible = False;
                  &rowChkSub3ReviewwithEmployee.Visible = False;
                  &rowChkSub3View.Visible = True;
                  &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub4UpdateandShare.Visible = False;
                  &rowChkSub4ReviewwithEmployee.Visible = False;
                  &rowChkSub4View.Visible = True;
                  &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub5UpdateandShare.Visible = False;
                  &rowChkSub5ReviewwithEmployee.Visible = False;
                  &rowChkSub5View.Visible = True;
                  &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub6UpdateandShare.Visible = False;
                  &rowChkSub6ReviewwithEmployee.Visible = False;
                  &rowChkSub6View.Visible = True;
                  &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               End-If;
               Break;
               
            When = "7"
               If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
               Else
                  &rowChkSub1UpdateandShare.Visible = False;
                  &rowChkSub1ReviewwithEmployee.Visible = False;
                  &rowChkSub1View.Visible = True;
                  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub2UpdateandShare.Visible = False;
                  &rowChkSub2ReviewwithEmployee.Visible = False;
                  &rowChkSub2View.Visible = True;
                  &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub3UpdateandShare.Visible = False;
                  &rowChkSub3ReviewwithEmployee.Visible = False;
                  &rowChkSub3View.Visible = True;
                  &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub4UpdateandShare.Visible = False;
                  &rowChkSub4ReviewwithEmployee.Visible = False;
                  &rowChkSub4View.Visible = True;
                  &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub5UpdateandShare.Visible = False;
                  &rowChkSub5ReviewwithEmployee.Visible = False;
                  &rowChkSub5View.Visible = True;
                  &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub6UpdateandShare.Visible = False;
                  &rowChkSub6ReviewwithEmployee.Visible = False;
                  &rowChkSub6View.Visible = True;
                  &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub7UpdateandShare.Visible = False;
                  &rowChkSub7ReviewwithEmployee.Visible = False;
                  &rowChkSub7View.Visible = True;
                  &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               End-If;
               Break;
            When = "8"
               If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
               Else
                  &rowChkSub1UpdateandShare.Visible = False;
                  &rowChkSub1ReviewwithEmployee.Visible = False;
                  &rowChkSub1View.Visible = True;
                  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub2UpdateandShare.Visible = False;
                  &rowChkSub2ReviewwithEmployee.Visible = False;
                  &rowChkSub2View.Visible = True;
                  &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub3UpdateandShare.Visible = False;
                  &rowChkSub3ReviewwithEmployee.Visible = False;
                  &rowChkSub3View.Visible = True;
                  &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub4UpdateandShare.Visible = False;
                  &rowChkSub4ReviewwithEmployee.Visible = False;
                  &rowChkSub4View.Visible = True;
                  &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub5UpdateandShare.Visible = False;
                  &rowChkSub5ReviewwithEmployee.Visible = False;
                  &rowChkSub5View.Visible = True;
                  &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub6UpdateandShare.Visible = False;
                  &rowChkSub6ReviewwithEmployee.Visible = False;
                  &rowChkSub6View.Visible = True;
                  &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub7UpdateandShare.Visible = False;
                  &rowChkSub7ReviewwithEmployee.Visible = False;
                  &rowChkSub7View.Visible = True;
                  &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub8UpdateandShare.Visible = False;
                  &rowChkSub8ReviewwithEmployee.Visible = False;
                  &rowChkSub8View.Visible = True;
                  &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               End-If;
               Break;
            When = "9"
               If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
               Else
                  &rowChkSub1UpdateandShare.Visible = False;
                  &rowChkSub1ReviewwithEmployee.Visible = False;
                  &rowChkSub1View.Visible = True;
                  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub2UpdateandShare.Visible = False;
                  &rowChkSub2ReviewwithEmployee.Visible = False;
                  &rowChkSub2View.Visible = True;
                  &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub3UpdateandShare.Visible = False;
                  &rowChkSub3ReviewwithEmployee.Visible = False;
                  &rowChkSub3View.Visible = True;
                  &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub4UpdateandShare.Visible = False;
                  &rowChkSub4ReviewwithEmployee.Visible = False;
                  &rowChkSub4View.Visible = True;
                  &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub5UpdateandShare.Visible = False;
                  &rowChkSub5ReviewwithEmployee.Visible = False;
                  &rowChkSub5View.Visible = True;
                  &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub6UpdateandShare.Visible = False;
                  &rowChkSub6ReviewwithEmployee.Visible = False;
                  &rowChkSub6View.Visible = True;
                  &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub7UpdateandShare.Visible = False;
                  &rowChkSub7ReviewwithEmployee.Visible = False;
                  &rowChkSub7View.Visible = True;
                  &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub8UpdateandShare.Visible = False;
                  &rowChkSub8ReviewwithEmployee.Visible = False;
                  &rowChkSub8View.Visible = True;
                  &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub9UpdateandShare.Visible = False;
                  &rowChkSub9ReviewwithEmployee.Visible = False;
                  &rowChkSub9View.Visible = True;
                  &rowChkSub9View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               End-If;
               Break;
            When = "10"
               If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
               Else
                  &rowChkSub1UpdateandShare.Visible = False;
                  &rowChkSub1ReviewwithEmployee.Visible = False;
                  &rowChkSub1View.Visible = True;
                  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub2UpdateandShare.Visible = False;
                  &rowChkSub2ReviewwithEmployee.Visible = False;
                  &rowChkSub2View.Visible = True;
                  &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub3UpdateandShare.Visible = False;
                  &rowChkSub3ReviewwithEmployee.Visible = False;
                  &rowChkSub3View.Visible = True;
                  &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub4UpdateandShare.Visible = False;
                  &rowChkSub4ReviewwithEmployee.Visible = False;
                  &rowChkSub4View.Visible = True;
                  &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub5UpdateandShare.Visible = False;
                  &rowChkSub5ReviewwithEmployee.Visible = False;
                  &rowChkSub5View.Visible = True;
                  &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub6UpdateandShare.Visible = False;
                  &rowChkSub6ReviewwithEmployee.Visible = False;
                  &rowChkSub6View.Visible = True;
                  &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub7UpdateandShare.Visible = False;
                  &rowChkSub7ReviewwithEmployee.Visible = False;
                  &rowChkSub7View.Visible = True;
                  &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub8UpdateandShare.Visible = False;
                  &rowChkSub8ReviewwithEmployee.Visible = False;
                  &rowChkSub8View.Visible = True;
                  &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub9UpdateandShare.Visible = False;
                  &rowChkSub9ReviewwithEmployee.Visible = False;
                  &rowChkSub9View.Visible = True;
                  &rowChkSub9View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub10UpdateandShare.Visible = False;
                  &rowChkSub10ReviewwithEmployee.Visible = False;
                  &rowChkSub10View.Visible = True;
                  &rowChkSub10View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               End-If;
               Break;
            When = "11"
            When = "F"
               If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
               Else
                  &rowChkSub1UpdateandShare.Visible = False;
                  &rowChkSub1ReviewwithEmployee.Visible = False;
                  &rowChkSub1View.Visible = True;
                  &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub2UpdateandShare.Visible = False;
                  &rowChkSub2ReviewwithEmployee.Visible = False;
                  &rowChkSub2View.Visible = True;
                  &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub3UpdateandShare.Visible = False;
                  &rowChkSub3ReviewwithEmployee.Visible = False;
                  &rowChkSub3View.Visible = True;
                  &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub4UpdateandShare.Visible = False;
                  &rowChkSub4ReviewwithEmployee.Visible = False;
                  &rowChkSub4View.Visible = True;
                  &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub5UpdateandShare.Visible = False;
                  &rowChkSub5ReviewwithEmployee.Visible = False;
                  &rowChkSub5View.Visible = True;
                  &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub6UpdateandShare.Visible = False;
                  &rowChkSub6ReviewwithEmployee.Visible = False;
                  &rowChkSub6View.Visible = True;
                  &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub7UpdateandShare.Visible = False;
                  &rowChkSub7ReviewwithEmployee.Visible = False;
                  &rowChkSub7View.Visible = True;
                  &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub8UpdateandShare.Visible = False;
                  &rowChkSub8ReviewwithEmployee.Visible = False;
                  &rowChkSub8View.Visible = True;
                  &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub9UpdateandShare.Visible = False;
                  &rowChkSub9ReviewwithEmployee.Visible = False;
                  &rowChkSub9View.Visible = True;
                  &rowChkSub9View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub10UpdateandShare.Visible = False;
                  &rowChkSub10ReviewwithEmployee.Visible = False;
                  &rowChkSub10View.Visible = True;
                  &rowChkSub10View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                  &rowChkSub11UpdateandShare.Visible = False;
                  &rowChkSub11ReviewwithEmployee.Visible = False;
                  &rowChkSub11View.Visible = True;
                  &rowChkSub11View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               End-If;
               Break;
            End-Evaluate;
            
         End-Evaluate;
      End-If;
      
      /* Fetch Datesave flages for all Scheduled Checkpoints from EP_APPR_CHECKPT  */
      
      /* If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then */
      If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "M" Or
            &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "E" Then
         
         &ChkptSql = CreateSQL(FetchSQL(SQL.EP_SEL_SCHED_CHKPTS), &HeaderRec.EP_APPRAISAL_ID.Value, &ChkPtNbr, &ChkptDueDate, &DataSaved);
         While &ChkptSql.Fetch(&ChkPtNbr, &ChkptDueDate, &DataSaved)
            &FetchedRows = &FetchedRows + 1;
            If All(&ChkPtNbr) Then
               Evaluate &ChkPtNbr
               When = 1
                  If &DataSaved = "Y" Then
                     &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                     &rowChkSub1View.Visible = True;
                  Else
                     &rowChkSub1View.Visible = False;
                  End-If;
               When = 2
                  If &DataSaved = "Y" Then
                     &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                     &rowChkSub2View.Visible = True;
                  Else
                     &rowChkSub2View.Visible = False;
                  End-If;
               When = 3
                  If &DataSaved = "Y" Then
                     &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                     &rowChkSub3View.Visible = True;
                  Else
                     &rowChkSub3View.Visible = False;
                  End-If;
               When = 4
                  If &DataSaved = "Y" Then
                     &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                     &rowChkSub4View.Visible = True;
                  Else
                     &rowChkSub4View.Visible = False;
                  End-If;
               When = 5
                  If &DataSaved = "Y" Then
                     &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                     &rowChkSub5View.Visible = True;
                  Else
                     &rowChkSub5View.Visible = False;
                  End-If;
               When = 6
                  If &DataSaved = "Y" Then
                     &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                     &rowChkSub6View.Visible = True;
                  Else
                     &rowChkSub6View.Visible = False;
                  End-If;
               When = 7
                  If &DataSaved = "Y" Then
                     &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                     &rowChkSub7View.Visible = True;
                  Else
                     &rowChkSub7View.Visible = False;
                  End-If;
               When = 8
                  If &DataSaved = "Y" Then
                     &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                     &rowChkSub8View.Visible = True;
                  Else
                     &rowChkSub8View.Visible = False;
                  End-If;
               When = 9
                  If &DataSaved = "Y" Then
                     &rowChkSub9View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                     &rowChkSub9View.Visible = True;
                  Else
                     &rowChkSub9View.Visible = False;
                  End-If;
               When = 10
                  If &DataSaved = "Y" Then
                     &rowChkSub10View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                     &rowChkSub10View.Visible = True;
                  Else
                     &rowChkSub10View.Visible = False;
                  End-If;
               When = 11
                  If &DataSaved = "Y" Then
                     &rowChkSub11View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
                     &rowChkSub11View.Visible = True;
                  Else
                     &rowChkSub11View.Visible = False;
                  End-If;
               End-Evaluate;
            End-If;
         End-While;
         &ChkptSql.Close();
         /* Else */
         Rem End-If;
      End-If;
      
   End-Evaluate;
   
   
   /* When Document in Establish Criteria not started or inprogress, then all Checkpoint first substep is grayed out */
   If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
         &HeaderRec.EP_EST_STATUS.Value = "IP" Then
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   End-If;
   
   
   
   
   
end-method;

method Final_substeps
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record, +/
   /+ &ECstepexist as Boolean +/
   
   Local number &ChkPtNbr;
   Local date &ChkptDueDate;
   Local SQL &ChkptSql;
   Local string &DataSaved;
   Local number &FetchedRows = 0;
   
   
   Local EP_FUNCTIONS:EP_Utilities &EP_Utilities = create EP_FUNCTIONS:EP_Utilities();
   Local EP_FUNCTIONS:WorkCenterUI &WorkCenterUI = create EP_FUNCTIONS:WorkCenterUI();
   
   /* Hide all row first */
   
   &rowFinalSubUpdateandClose.Visible = False;
   &rowFinalSubview.Visible = False;
   &rowFinalSubReopen.Visible = False;
   
   Evaluate &HeaderRec.EP_TRKPROG_STATUS.Value
   When = "NS"
   When = "IP"
      
      /*************************************/
      /*  Track Progress is In Progress    */
      /*************************************/
      
      Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
      When = "E" /* Employee */
         /*************************************/
         /*  Employee -  In Progress          */
         /*************************************/
         
         
         If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
               &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
               (&HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Or
                  &HeaderRec.EP_MGR_CMNT_SHARED.Value = "Y") Then
            /*Update */
            &rowChkSub1UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowChkSub2UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowChkSub3UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowChkSub4UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowChkSub5UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowChkSub6UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowChkSub7UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowChkSub8UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowChkSub9UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowChkSub10UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowChkSub11UpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         End-If;
         
         If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" And
               &HeaderRec.EP_TP_EE_CMNTS_SW.Value = "N" And
               &HeaderRec.EP_MGR_CMNT_SHARED.Value = "N" Then
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub3UpdateandShare.Visible = False;
            &rowChkSub4UpdateandShare.Visible = False;
            &rowChkSub5UpdateandShare.Visible = False;
            &rowChkSub6UpdateandShare.Visible = False;
            &rowChkSub7UpdateandShare.Visible = False;
            &rowChkSub8UpdateandShare.Visible = False;
            &rowChkSub9UpdateandShare.Visible = False;
            &rowChkSub10UpdateandShare.Visible = False;
            &rowChkSub11UpdateandShare.Visible = False;
         End-If;
         
         
         /*EE can Complete or Both can complete */
         
         If (&HeaderRec.EP_TP_COMP_BY_FLG.Value = "B" Or
               &HeaderRec.EP_TP_COMP_BY_FLG.Value = "E") And
               &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" Then
            
            &rowFinalSubUpdateandClose.Visible = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If &HeaderRec.EP_TP_SUB_STATUS.Value = "F" Then
               If &GBL_TP_same_focus Then
               Else
                  &rowFinalSubUpdateandClose.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
            <* Else
            &rowFinalSubview.Visible = True;
            &rowFinalSubview.EP_BTN_LINK_WRK.EP_STEP_LINK.DisplayOnly = False;*>
         End-If;
         
         
         
         /* Finalize: If only manager can complete and EE can update*/
         If &HeaderRec.EP_TP_COMP_BY_FLG.Value = "M" And
               &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" Then
            
            &rowFinalSubUpdateandClose.Visible = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            /* EE update */
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB6_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If &HeaderRec.EP_TP_SUB_STATUS.Value = "F" Then
               If &GBL_TP_same_focus Then
               Else
                  &rowFinalSubUpdateandClose.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
         End-If;
         /* Bug 162749494 Finalize: If only manager can update Mid-period, and only manager can completed Finalize Criteria */
         /* EE should be able to view Finalize criteria */
         If &HeaderRec.EP_TP_COMP_BY_FLG.Value = "M" And
               &HeaderRec.EP_TP_UPD_BY_FLG.Value = "M" Then
            
            &rowFinalSubview.Visible = True;
            &rowFinalSubview.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            /* EE can View */
            &rowFinalSubview.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB4", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            
            If &HeaderRec.EP_TP_SUB_STATUS.Value = "F" Then
               If &GBL_TP_same_focus Then
               Else
                  &rowFinalSubview.Style = "PSGRIDROWSELECTED";
               End-If;
               
            End-If;
         End-If;
         /* End Bug 162749494 */
         
         Break;
         
      When = "M" /* Manager */
         
         /*************************************/
         /*  Manager  -  In Progress          */
         /*************************************/
         rem &rowChkSub1Update.Visible = False;
         rem &rowChkSub2Update.Visible = False;
         
         
         /* Finalize, if Manager/Both can complete the Track Progress */
         
         If (&HeaderRec.EP_TP_COMP_BY_FLG.Value = "M" Or
               &HeaderRec.EP_TP_COMP_BY_FLG.Value = "B") And
               &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
            
            
            &rowFinalSubUpdateandClose.Visible = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If &HeaderRec.EP_TP_SUB_STATUS.Value = "F" Then
               If &GBL_TP_same_focus Then
               Else
                  &rowFinalSubUpdateandClose.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
            
            <* Else
            &rowFinalSubview.Visible = True;
            &rowFinalSubview.EP_BTN_LINK_WRK.EP_STEP_LINK.DisplayOnly = False;*>
         End-If;
         
         
         
         /* Bug 16270978 */
         /* Finalize, if manager can't complete the Finalize Criteria, but can update the mid-period */
         /* still should have a update sub-step in the Finalize Criteria step */
         /* Finalize, if Manager can't  complete the Track Progress */
         
         If &HeaderRec.EP_TP_UPD_BY_FLG.Value = "B" And
               &HeaderRec.EP_TP_COMP_BY_FLG.Value = "E" And
               &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
            /* End Bug 16270978 */
            &rowFinalSubUpdateandClose.Visible = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            /* Manager: Update */
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("TP_SUB6_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If &HeaderRec.EP_TP_SUB_STATUS.Value = "F" Then
               If &GBL_TP_same_focus Then
               Else
                  &rowFinalSubUpdateandClose.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
            
            
            <* Else
            &rowFinalSubview.Visible = True;
            &rowFinalSubview.EP_BTN_LINK_WRK.EP_STEP_LINK.DisplayOnly = False;*>
            
         End-If;
         
         
      When = "V" /* View-Only Manager */
      When = "H" /* HR Admin */
         
         /* "V" and "HR" can view only */
         
         &rowFinalSubUpdateandClose.Visible = False;
         &rowFinalSubview.Visible = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "F" Then
            &rowFinalSubview.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         Else
            &rowFinalSubview.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
         Break;
      When-Other
         Break;
         
      End-Evaluate;
      
      
   When = "CO" /* Complete */
      /*************************************/
      /*  Track Progress is Complete       */
      /*************************************/
      &rowFinalSubUpdateandClose.Visible = False;
      &rowFinalSubview.Visible = True;
      &rowFinalSubview.EP_BTN_LINK_WRK.EP_STEP_LINK.DisplayOnly = False;
      
      /* if there are saved Finalize Goal, enable the View Link for Finalize Goal */
      
      If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "M" Or
            &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "E" Then
         SQLExec(SQL.EP_SEL_FINALCHKPT_SAVED, &EP_GBLKEYS_WRK.EP_APPRAISAL_ID.Value, &DataSaved);
         If &DataSaved = "Y" Then
            &rowFinalSubview.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowFinalSubview.Visible = True;
         Else
            &rowFinalSubview.Visible = False;
         End-If;
      Else
      End-If;
      Break;
   End-Evaluate;
   
   
   /* Before finalize step stage, all finalize substep should be inactive */
   If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "M" Or
         &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "E" Then
      Evaluate &HeaderRec.EP_TP_NBR_CHECKPTS.Value
      When = 1
         Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
         When = "1"
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowFinalSubview.Visible = False;
            Break;
         End-Evaluate;
      When = 2
         Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
         When = "1"
         When = "2"
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowFinalSubview.Visible = False;
            Break;
         End-Evaluate;
      When = 3
         Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
         When = "1"
         When = "2"
         When = "3"
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowFinalSubview.Visible = False;
            Break;
         End-Evaluate;
      When = 4
         Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
         When = "1"
         When = "2"
         When = "3"
         When = "4"
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowFinalSubview.Visible = False;
            Break;
         End-Evaluate;
      When = 5
         Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
         When = "1"
         When = "2"
         When = "3"
         When = "4"
         When = "5"
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowFinalSubview.Visible = False;
            Break;
         End-Evaluate;
      When = 6
         Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
         When = "1"
         When = "2"
         When = "3"
         When = "4"
         When = "5"
         When = "6"
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowFinalSubview.Visible = False;
            Break;
         End-Evaluate;
      When = 7
         Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
         When = "1"
         When = "2"
         When = "3"
         When = "4"
         When = "5"
         When = "6"
         When = "7"
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowFinalSubview.Visible = False;
            Break;
         End-Evaluate;
      When = 8
         Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
         When = "1"
         When = "2"
         When = "3"
         When = "4"
         When = "5"
         When = "6"
         When = "7"
         When = "8"
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowFinalSubview.Visible = False;
            Break;
         End-Evaluate;
      When = 9
         Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
         When = "1"
         When = "2"
         When = "3"
         When = "4"
         When = "5"
         When = "6"
         When = "7"
         When = "8"
         When = "9"
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowFinalSubview.Visible = False;
            Break;
         End-Evaluate;
      When = 10
         Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
         When = "1"
         When = "2"
         When = "3"
         When = "4"
         When = "5"
         When = "6"
         When = "7"
         When = "8"
         When = "9"
         When = "10"
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowFinalSubview.Visible = False;
            Break;
         End-Evaluate;
      When = 11
         Evaluate &HeaderRec.EP_TP_SUB_STATUS.Value
         When = "1"
         When = "2"
         When = "3"
         When = "4"
         When = "5"
         When = "6"
         When = "7"
         When = "8"
         When = "9"
         When = "10"
         When = "11"
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowFinalSubview.Visible = False;
            Break;
         End-Evaluate;
      End-Evaluate;
   End-If;
   
   /* Cancel */
   If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
      Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
      When = "E"
      When = "H"
      When = "V"
         &rowFinalSubview.Visible = True;
         &rowFinalSubview.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "F" Then
            &rowFinalSubview.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         End-If;
         Break;
      When = "M"
         &rowFinalSubUpdateandClose.Visible = True;
         &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         If &HeaderRec.EP_TP_SUB_STATUS.Value = "F" Then
            &rowFinalSubUpdateandClose.Visible = False;
            &rowFinalSubview.Visible = True;
            &rowFinalSubview.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         End-If;
         Break;
      End-Evaluate;
      
      
   End-If;
   
   /*In Finalize step, all previous check points are completed  */
   If &HeaderRec.EP_TP_SUB_STATUS.Value = "F" Then
      If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "M" Or
            &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "E" Then
         Evaluate &HeaderRec.EP_TP_NBR_CHECKPTS.Value
         When = 1
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            Break;
         When = 2
            
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub2ReviewwithEmployee.Visible = False;
            
            Break;
            
         When = 3
            
            
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub2ReviewwithEmployee.Visible = False;
            &rowChkSub3UpdateandShare.Visible = False;
            &rowChkSub3ReviewwithEmployee.Visible = False;
            Break;
            
         When = 4
            
            
            
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub2ReviewwithEmployee.Visible = False;
            &rowChkSub3UpdateandShare.Visible = False;
            &rowChkSub3ReviewwithEmployee.Visible = False;
            &rowChkSub4UpdateandShare.Visible = False;
            &rowChkSub4ReviewwithEmployee.Visible = False;
            
         When = 5
            
            
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub2ReviewwithEmployee.Visible = False;
            &rowChkSub3UpdateandShare.Visible = False;
            &rowChkSub3ReviewwithEmployee.Visible = False;
            &rowChkSub4UpdateandShare.Visible = False;
            &rowChkSub4ReviewwithEmployee.Visible = False;
            &rowChkSub5UpdateandShare.Visible = False;
            &rowChkSub5ReviewwithEmployee.Visible = False;
            Break;
            
         When = 6
            
            
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub2ReviewwithEmployee.Visible = False;
            &rowChkSub3UpdateandShare.Visible = False;
            &rowChkSub3ReviewwithEmployee.Visible = False;
            &rowChkSub4UpdateandShare.Visible = False;
            &rowChkSub4ReviewwithEmployee.Visible = False;
            &rowChkSub5UpdateandShare.Visible = False;
            &rowChkSub5ReviewwithEmployee.Visible = False;
            &rowChkSub6UpdateandShare.Visible = False;
            &rowChkSub6ReviewwithEmployee.Visible = False;
            
            Break;
         When = 7
            
            
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub2ReviewwithEmployee.Visible = False;
            &rowChkSub3UpdateandShare.Visible = False;
            &rowChkSub3ReviewwithEmployee.Visible = False;
            &rowChkSub4UpdateandShare.Visible = False;
            &rowChkSub4ReviewwithEmployee.Visible = False;
            &rowChkSub5UpdateandShare.Visible = False;
            &rowChkSub5ReviewwithEmployee.Visible = False;
            &rowChkSub6UpdateandShare.Visible = False;
            &rowChkSub6ReviewwithEmployee.Visible = False;
            &rowChkSub7UpdateandShare.Visible = False;
            &rowChkSub7ReviewwithEmployee.Visible = False;
            
            Break;
            
         When = 8
            
            
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub2ReviewwithEmployee.Visible = False;
            &rowChkSub3UpdateandShare.Visible = False;
            &rowChkSub3ReviewwithEmployee.Visible = False;
            &rowChkSub4UpdateandShare.Visible = False;
            &rowChkSub4ReviewwithEmployee.Visible = False;
            &rowChkSub5UpdateandShare.Visible = False;
            &rowChkSub5ReviewwithEmployee.Visible = False;
            &rowChkSub6UpdateandShare.Visible = False;
            &rowChkSub6ReviewwithEmployee.Visible = False;
            &rowChkSub7UpdateandShare.Visible = False;
            &rowChkSub7ReviewwithEmployee.Visible = False;
            &rowChkSub8UpdateandShare.Visible = False;
            &rowChkSub8ReviewwithEmployee.Visible = False;
            
            
            Break;
            
         When = 9
            
            
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub2ReviewwithEmployee.Visible = False;
            &rowChkSub3UpdateandShare.Visible = False;
            &rowChkSub3ReviewwithEmployee.Visible = False;
            &rowChkSub4UpdateandShare.Visible = False;
            &rowChkSub4ReviewwithEmployee.Visible = False;
            &rowChkSub5UpdateandShare.Visible = False;
            &rowChkSub5ReviewwithEmployee.Visible = False;
            &rowChkSub6UpdateandShare.Visible = False;
            &rowChkSub6ReviewwithEmployee.Visible = False;
            &rowChkSub7UpdateandShare.Visible = False;
            &rowChkSub7ReviewwithEmployee.Visible = False;
            &rowChkSub8UpdateandShare.Visible = False;
            &rowChkSub8ReviewwithEmployee.Visible = False;
            &rowChkSub9UpdateandShare.Visible = False;
            &rowChkSub9ReviewwithEmployee.Visible = False;
            
            Break;
         When = 10
            
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub2ReviewwithEmployee.Visible = False;
            &rowChkSub3UpdateandShare.Visible = False;
            &rowChkSub3ReviewwithEmployee.Visible = False;
            &rowChkSub4UpdateandShare.Visible = False;
            &rowChkSub4ReviewwithEmployee.Visible = False;
            &rowChkSub5UpdateandShare.Visible = False;
            &rowChkSub5ReviewwithEmployee.Visible = False;
            &rowChkSub6UpdateandShare.Visible = False;
            &rowChkSub6ReviewwithEmployee.Visible = False;
            &rowChkSub7UpdateandShare.Visible = False;
            &rowChkSub7ReviewwithEmployee.Visible = False;
            &rowChkSub8UpdateandShare.Visible = False;
            &rowChkSub8ReviewwithEmployee.Visible = False;
            &rowChkSub9UpdateandShare.Visible = False;
            &rowChkSub9ReviewwithEmployee.Visible = False;
            &rowChkSub10UpdateandShare.Visible = False;
            &rowChkSub10ReviewwithEmployee.Visible = False;
            
            Break;
            
         When = 11
            
            
            &rowChkSub1UpdateandShare.Visible = False;
            &rowChkSub1ReviewwithEmployee.Visible = False;
            &rowChkSub2UpdateandShare.Visible = False;
            &rowChkSub2ReviewwithEmployee.Visible = False;
            &rowChkSub3UpdateandShare.Visible = False;
            &rowChkSub3ReviewwithEmployee.Visible = False;
            &rowChkSub4UpdateandShare.Visible = False;
            &rowChkSub4ReviewwithEmployee.Visible = False;
            &rowChkSub5UpdateandShare.Visible = False;
            &rowChkSub5ReviewwithEmployee.Visible = False;
            &rowChkSub6UpdateandShare.Visible = False;
            &rowChkSub6ReviewwithEmployee.Visible = False;
            &rowChkSub7UpdateandShare.Visible = False;
            &rowChkSub7ReviewwithEmployee.Visible = False;
            &rowChkSub8UpdateandShare.Visible = False;
            &rowChkSub8ReviewwithEmployee.Visible = False;
            &rowChkSub9UpdateandShare.Visible = False;
            &rowChkSub9ReviewwithEmployee.Visible = False;
            &rowChkSub10UpdateandShare.Visible = False;
            &rowChkSub10ReviewwithEmployee.Visible = False;
            &rowChkSub11UpdateandShare.Visible = False;
            &rowChkSub11ReviewwithEmployee.Visible = False;
            Break;
         End-Evaluate;
      Else
      End-If;
      
   End-If;
   
   /* If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then*/
   <*If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "M" Or
            &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "E" Then*>
   &ChkptSql = CreateSQL(FetchSQL(SQL.EP_SEL_SCHED_CHKPTS), &HeaderRec.EP_APPRAISAL_ID.Value, &ChkPtNbr, &ChkptDueDate, &DataSaved);
   While &ChkptSql.Fetch(&ChkPtNbr, &ChkptDueDate, &DataSaved)
      &FetchedRows = &FetchedRows + 1;
      If All(&ChkPtNbr) Then
         Evaluate &ChkPtNbr
         When = 1
            If &DataSaved = "Y" Then
               &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub1View.Visible = True;
            Else
               /* For the view-only mode, show view link. */
               
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
                     &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
                  &rowChkSub1View.Visible = True;
               Else
                  &rowChkSub1View.Visible = False;
               End-If;
            End-If;
         When = 2
            If &DataSaved = "Y" Then
               &rowChkSub2View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub2View.Visible = True;
            Else
               
               /* For the view-only mode, show view link. */
               
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
                     &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
                  &rowChkSub2View.Visible = True;
               Else
                  &rowChkSub2View.Visible = False;
               End-If;
            End-If;
         When = 3
            If &DataSaved = "Y" Then
               &rowChkSub3View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub3View.Visible = True;
            Else
               /* For the view-only mode, show view link. */
               
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
                     &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
                  &rowChkSub3View.Visible = True;
               Else
                  &rowChkSub3View.Visible = False;
               End-If;
            End-If;
         When = 4
            If &DataSaved = "Y" Then
               &rowChkSub4View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub4View.Visible = True;
            Else
               /* For the view-only mode, show view link. */
               
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
                     &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
                  &rowChkSub4View.Visible = True;
               Else
                  &rowChkSub4View.Visible = False;
               End-If;
            End-If;
         When = 5
            If &DataSaved = "Y" Then
               &rowChkSub5View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub5View.Visible = True;
            Else
               /* For the view-only mode, show view link. */
               
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
                     &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
                  &rowChkSub5View.Visible = True;
               Else
                  &rowChkSub5View.Visible = False;
               End-If;
            End-If;
         When = 6
            If &DataSaved = "Y" Then
               &rowChkSub6View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub6View.Visible = True;
            Else
               /* For the view-only mode, show view link. */
               
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
                     &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
                  &rowChkSub6View.Visible = True;
               Else
                  &rowChkSub6View.Visible = False;
               End-If;
            End-If;
         When = 7
            If &DataSaved = "Y" Then
               &rowChkSub7View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub7View.Visible = True;
            Else
               /* For the view-only mode, show view link. */
               
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
                     &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
                  &rowChkSub7View.Visible = True;
               Else
                  &rowChkSub7View.Visible = False;
               End-If;
            End-If;
         When = 8
            If &DataSaved = "Y" Then
               &rowChkSub8View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub8View.Visible = True;
            Else
               /* For the view-only mode, show view link. */
               
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
                     &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
                  &rowChkSub8View.Visible = True;
               Else
                  &rowChkSub8View.Visible = False;
               End-If;
            End-If;
         When = 9
            If &DataSaved = "Y" Then
               &rowChkSub9View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub9View.Visible = True;
            Else
               /* For the view-only mode, show view link. */
               
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
                     &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
                  &rowChkSub9View.Visible = True;
               Else
                  &rowChkSub9View.Visible = False;
               End-If;
            End-If;
         When = 10
            If &DataSaved = "Y" Then
               &rowChkSub10View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub10View.Visible = True;
            Else
               /* For the view-only mode, show view link. */
               
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
                     &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
                  &rowChkSub10View.Visible = True;
               Else
                  &rowChkSub10View.Visible = False;
               End-If;
            End-If;
         When = 11
            If &DataSaved = "Y" Then
               &rowChkSub11View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowChkSub11View.Visible = True;
            Else
               /* For the view-only mode, show view link. */
               
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
                     &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
                  &rowChkSub11View.Visible = True;
               Else
                  &rowChkSub11View.Visible = False;
               End-If;
            End-If;
         End-Evaluate;
      End-If;
   End-While;
   &ChkptSql.Close();
   
   
   /* Canceled */
   Local string &RoleDocStatus;
   SQLExec(SQL.EP_ROLE_STATUS, &EP_GBLKEYS_WRK.EP_APPRAISAL_ID.Value, &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, &RoleDocStatus);
   
   If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" And
         &HeaderRec.EP_TP_SUB_STATUS.Value = "F" Then
      If &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Or
            &HeaderRec.EP_TRKPROG_STATUS.Value = "IP" Or
            (&HeaderRec.EP_TRKPROG_STATUS.Value = "CO" And
               None(&RoleDocStatus)) Or
            (&HeaderRec.EP_TRKPROG_STATUS.Value = "CO" And
               &RoleDocStatus = "NS") Then
         &rowFinalSubUpdateandClose.Visible = False;
         &rowFinalSubview.Visible = True;
      End-If;
   End-If;
   
   
   
   /* if Track Progress is not started and it is first step, show icon as in progress and highlight the step */
   If &HeaderRec.EP_EST_STATUS.Value = "NA" And
         &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Then
      
      If &rowFinalSubUpdateandClose.Visible Then
         &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowFinalSubUpdateandClose.Style = "PSGRIDROWSELECTED";
      End-If;
      
      
   End-If;
   
   /* When Document in Establish Criteria not started or inprogress, then Finalize first substep is grayed out */
   If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
         &HeaderRec.EP_EST_STATUS.Value = "IP" Then
      &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowFinalSubUpdateandClose.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      /* Bug 20333159*/
      &rowChkSub1View.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      /* End Bug 20333159*/
   End-If;
   
   
   
   /*  logic to display or hide the TP re-open hyperlink  */
   
   &rowFinalSubReopen.Visible = False;
   
   If &CMP_AutoStarted = "EV" Then
      /*  the Evaluation step was auto-started, check to see whether or not to display the TP re-open link  */
      Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
      When = "E"
         If (&HeaderRec.EP_TP_COMP_BY_FLG.Value = "B" Or
               &HeaderRec.EP_TP_COMP_BY_FLG.Value = "E") And
               &EP_Utilities.CanReOpenBaseline(&HeaderRec.EP_APPRAISAL_ID.Value) Then
            
            &rowFinalSubReopen.Visible = True;
         End-If;
         Break;
         
      When = "M"
         
         If (&HeaderRec.EP_TP_COMP_BY_FLG.Value = "M" Or
               &HeaderRec.EP_TP_COMP_BY_FLG.Value = "B") And
               &EP_Utilities.CanReOpenBaseline(&HeaderRec.EP_APPRAISAL_ID.Value) Then
            &rowFinalSubReopen.Visible = True;
         End-If;
         Break;
         
      When = "H"
         If &EP_Utilities.CanReOpenBaseline(&HeaderRec.EP_APPRAISAL_ID.Value) Then
            
            &rowFinalSubReopen.Visible = True;
         End-If;
         Break;
      End-Evaluate;
   End-If;
   
   
end-method;

method Nominate_substeps
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local string &strNomListExists;
   
   Evaluate &HeaderRec.EP_NOM_STATUS.Value
   When = "NS"
   When = "IP"
      
      Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
         /* Check access to the document and what their access should be */
      When = "E"
         /* Hide View Nominee substep all the time */
         &rowNomSubViewNom.Visible = False;
         
         If (&HeaderRec.EP_NOM_UPD_EE_SW.Value = "Y" And
               &HeaderRec.EP_REVIEW_STATUS.Value <> "CA") Or
               (&HeaderRec.EP_NOM_SUB_ROLE.Value = "E" And
                  &HeaderRec.EP_REVIEW_STATUS.Value <> "CA") Then
            &rowNomSubAdd.Visible = True;
         Else
            &rowNomSubAdd.Visible = False;
         End-If;
         
         If &HeaderRec.EP_NOM_SUB_ROLE.Value = "E" Then
            SQLExec(SQL.EP_SELECT_APPR_NOM_LIST, &EP_GBLKEYS_WRK.EP_APPRAISAL_ID.Value, &strNomListExists);
            /* Bug 11774400 */
            If None(&strNomListExists) Or
                  (&HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "IP") Then
               /* Add */
               &rowNomSubAdd.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("NOM_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            Else
               /* Add and Submit */
               &rowNomSubAdd.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("NOM_SUB1_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            End-If;
         End-If;
         
         
         If &HeaderRec.EP_NOM_TRK_EE_SW.Value = "Y" Then
            &rowNomSubTrk.Visible = True;
         Else
            &rowNomSubTrk.Visible = False;
         End-If;
         
         
      When = "M"
         /* Hide View Nominee substep all the time */
         
         &rowNomSubViewNom.Visible = False;
         
         
         If (&HeaderRec.EP_NOM_UPD_MGR_SW.Value = "Y" And
               &HeaderRec.EP_REVIEW_STATUS.Value <> "CA") Or
               (&HeaderRec.EP_NOM_SUB_ROLE.Value = "M" And
                  &HeaderRec.EP_REVIEW_STATUS.Value <> "CA") Then
            &rowNomSubAdd.Visible = True;
         Else
            &rowNomSubAdd.Visible = False;
         End-If;
         
         If &HeaderRec.EP_NOM_SUB_ROLE.Value = "M" Then
            SQLExec(SQL.EP_SELECT_APPR_NOM_LIST, &EP_GBLKEYS_WRK.EP_APPRAISAL_ID.Value, &strNomListExists);
            /* Bug 11774400 */
            If None(&strNomListExists) Or
                  (&HeaderRec.EP_EST_STATUS.Value = "NS" Or
                     &HeaderRec.EP_EST_STATUS.Value = "IP" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Or
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "IP") Then
               /* Add */
               &rowNomSubAdd.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("NOM_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            Else
               /* Add and Submit */
               &rowNomSubAdd.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("NOM_SUB1_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            End-If;
         End-If;
         
         
         If &HeaderRec.EP_NOM_TRK_MGR_SW.Value = "Y" Then
            &rowNomSubTrk.Visible = True;
         End-If;
         
      When = "O"
         Break;
      When = "V"
      When = "H"
         &rowNomSubViewNom.Visible = True;
         &rowNomSubTrk.Visible = True;
         &rowNomSubAdd.Visible = False;
         
         Break;
         
      End-Evaluate;
      
      
   When = "CO"
      /* if it is completed, only show View Nominees and Track Nominations link */
      &rowNomSubAdd.Visible = False;
      &rowNomSubViewNom.Visible = False;
      &rowNomSubTrk.Visible = True;
      
   End-Evaluate;
   
   /* Gray out Nomination sub steps until Establish Criteria or Track Progress has started */
   If &HeaderRec.EP_REVIEW_STATUS.Value = "CO" Or
         &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
      &rowNomSubViewNom.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowNomSubTrk.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowNomSubAdd.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      
   Else
      &rowNomSubViewNom.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowNomSubTrk.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      &rowNomSubAdd.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
   End-If;
   
   
end-method;

method View_Participant_substep
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record +/
   Local number &Count;
   Local string &RoleDocStatus;
   /* Only display the substep view link when Manager or Employee doesn't have view participant access */
   
   
   Evaluate &HeaderRec.EP_PRT_STATUS.Value
   When = "NS" /* Not Started */
   When = "IP" /* In Progress */
   When = "CO" /* Complete */
      Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
      When "E"
         If &HeaderRec.EP_TRK_FDBK_EE_SW.Value = "N" Then
            &rowPrtSubView.Visible = False;
         End-If;
      When = "M"
      When = "V"
         If &HeaderRec.EP_TRK_FDBK_MGR_SW.Value = "N" Then
            &rowPrtSubView.Visible = False;
         End-If;
      When = "O"
         &rowPrtSubView.Visible = False;
      When = "H"
         Break;
      When-Other
      End-Evaluate;
      /* If Participant status is not started, disable the view link */
      If &HeaderRec.EP_PRT_STATUS.Value = "NS" Then
         &rowPrtSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         
      End-If;
      
      
   End-Evaluate;
   
   SQLExec(SQL.EP_OTHER_ROLE_STATUS, &EP_GBLKEYS_WRK.EP_APPRAISAL_ID.Value, &RoleDocStatus);
   If &RoleDocStatus = "CA" Then
      &rowPrtSubView.Visible = True;
      &rowPrtSubView.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowPrtSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
   End-If;
   
end-method;




method Self_Substeps
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record, +/
   /+ &strEmpDocStatus as String, +/
   /+ &bolEmpDocDoesExist as Boolean +/
   
   /* Sub Steps for Employee Self Evaluation */
   
   
   Evaluate &strEmpDocStatus
   When = "NS"
   When = "IP"
      rem &rowEmpSubupdateandComplete.Visible = False;
      rem  &rowEmpSubView.Visible = False;
      
      
      Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
      When = "E" /* Employee */
         /* EE Role When EE role access, if Review Status is not "Canceled", show update and Complete, hide view */
         /* Else show view, hide update and completed */
         
         If &HeaderRec.EP_REVIEW_STATUS.Value <> "CA" Then
            
            &rowEmpSubupdateandComplete.Visible = True;
            &rowEmpSubupdateandComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("SELF_SUB1", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowEmpSubupdateandComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowEmpSubupdateandComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowEmpSubupdateandComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowEmpSubupdateandComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If (&HeaderRec.EP_EST_STATUS.Value = "CO" And
                  &HeaderRec.EP_TRKPROG_STATUS.Value = "NA") Or
                  (&HeaderRec.EP_EST_STATUS.Value = "NA" And
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "CO") Or
                  (&HeaderRec.EP_EST_STATUS.Value = "CO" And
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "CO") Or
                  (&HeaderRec.EP_EST_STATUS.Value = "NA" And
                     &HeaderRec.EP_TRKPROG_STATUS.Value = "NA") Then
               &rowEmpSubupdateandComplete.Style = "PSGRIDROWSELECTED";
            End-If;
            &rowEmpSubView.Visible = False;
         Else
            rem rowEmpSubupdateandComplete.Visible = False;
            &rowEmpSubView.Visible = True;
         End-If;
         Break;
         /* Other Role access, show view, hide update and complete */
      When-Other
         &rowEmpSubupdateandComplete.Visible = False;
         &rowEmpSubView.Visible = True;
         
         If &strEmpDocStatus = "NS" Then
            &rowEmpSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowEmpSubView.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
         End-If;
         Break;
      End-Evaluate;
      /* Review Status is Completed, show view, hide update and complete */
   When = "CO"
      
      &rowEmpSubupdateandComplete.Visible = False;
      &rowEmpSubView.Visible = True;
      &rowEmpSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
      rem &rowEmpSubView.Style = "PSGRIDROWSELECTED";
      
      Break;
      /* Review Status is Canceled, show view, hide update and complete */
   When = "CA"
      
      &rowEmpSubupdateandComplete.Visible = False;
      &rowEmpSubView.Visible = True;
      Break;
   End-Evaluate;
   /* When Establish Criteria/Track Progress is not started or in Progress, disable all Self Service steps */
   If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
         &HeaderRec.EP_EST_STATUS.Value = "IP" Or
         &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Or
         &HeaderRec.EP_TRKPROG_STATUS.Value = "IP" Then
      &rowEmpSubupdateandComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowEmpSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowEmpSubupdateandComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowEmpSubView.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   End-If;
   
end-method;

method Manager_substeps
   /+ &rssubstep as Rowset, +/
   /+ &HeaderRec as Record, +/
   /+ &strEmpDocStatus as String, +/
   /+ &strMgrDocStatus as String, +/
   /+ &bolMgrDocDoesExist as Boolean +/
   
   Local boolean &Ismanagerstepcurrent = False;
   /* Only MAnager Evaluation is current step, set &Ismanagerstepcurrent to True */
   If (&HeaderRec.EP_EST_STATUS.Value = "CO" And
         &HeaderRec.EP_TRKPROG_STATUS.Value = "NA") Or
         (&HeaderRec.EP_EST_STATUS.Value = "NA" And
            &HeaderRec.EP_TRKPROG_STATUS.Value = "CO") Or
         (&HeaderRec.EP_EST_STATUS.Value = "CO" And
            &HeaderRec.EP_TRKPROG_STATUS.Value = "CO") Or
         (&HeaderRec.EP_EST_STATUS.Value = "NA" And
            &HeaderRec.EP_TRKPROG_STATUS.Value = "NA") Then
      &Ismanagerstepcurrent = True;
   End-If;
   
   /* Hide all steps first */
   &rowMgrSubUpdateandSubmit.Visible = False;
   &rowMgrSubApproval.Visible = False;
   &rowMgrSubUpdateandComplete.Visible = False;
   &rowMgrSubUpdateandShare.Visible = False;
   &rowMgrSubReqestAcknowledgement.Visible = False;
   &rowMgrSubOverrideAcknowledgement.Visible = False;
   &rowMgrSubComplete.Visible = False;
   &rowMgrSubPA.Visible = False;
   &rowMgrSubView.Visible = False;
   
   Evaluate &strMgrDocStatus
   When = "PA" /*Pending Approval */
      
      Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
      When = "M" /* Manager */
         
         Evaluate &HeaderRec.EP_EE_REVIEW_FLG.Value
         When = "01" /* Approval Before EE Review Held */
            Evaluate &HeaderRec.EP_APPROVAL_STATUS.Value
            When = "OPEN" /* Open (i.e. not submitted yet) */
               
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                     
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
            When = "DENY" /* Denied */
               
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               Break;
            When = "SUBM" /* Submitted */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubApproval.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
            When = "APRV" /* Approved (isn't possible to be approved and still in progress) */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubApproval.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
            End-Evaluate;
            /* 9.2 FP1 added Approval Before 2 process */
         When = "07" /* Approval Before 2 Process */
            Evaluate &HeaderRec.EP_APPROVAL_STATUS.Value
            When = "OPEN" /* Open (i.e. not submitted yet) */
               
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                     
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               Break;
            When = "DENY" /* Denied */
               
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               Break;
            When = "SUBM" /* Submitted */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubApproval.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               
               Break;
            When = "APRV" /* Approved (isn't possible to be approved and still in progress) */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubApproval.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               
               Break;
            End-Evaluate;
            
         When = "02" /* Approval After EE Review Held */
            Evaluate &HeaderRec.EP_APPROVAL_STATUS.Value
            When = "OPEN" /* Open (i.e. not submitted yet) */
               
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Flow 2 change view link to label to complete */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
               
               
            When = "DENY" /* Denied */
               
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               
               
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Flow 2 change view link to label to complete */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
               
               
            When = "SUBM" /* Submitted */
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* Sumbit for Approval */
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubPA.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Flow 2 change view link to label to complete */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
               
            When = "APRV" /* Approved */
               
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* Sumbit for Approval */
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubPA.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Flow 2 change view link to label to complete */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
            When-Other
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               /* Flow 2 change view link to label to complete */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
               
            End-Evaluate;
            
            /*9.2 FP1 added Approval after 3 process */
            
         When = "08" /* Approval After 3 Process */
            Evaluate &HeaderRec.EP_APPROVAL_STATUS.Value
            When = "OPEN" /* Open (i.e. not submitted yet) */
               
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               
               Break;
            When = "DENY" /* Denied */
               
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               
               
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
               
            When = "SUBM" /* Submitted */
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* Sumbit for Approval */
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubPA.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               
               
               Break;
            When = "APRV" /* Approved */
               
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* Sumbit for Approval */
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubPA.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               
               Break;
            When-Other
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               /* Flow 8 change view link to label to complete */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
               
            End-Evaluate;
         When = "03" /* No Approval, EE Review Held */
            
            &rowMgrSubUpdateandShare.Visible = True;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowMgrSubReqestAcknowledgement.Visible = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowMgrSubComplete.Visible = True;
            &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* Complete */
            &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            
            Break;
            /* 92 FP1 Added No Approval 2 Process */
            
         When = "06" /* No Approval 2 Process */
            
            &rowMgrSubUpdateandShare.Visible = True;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            Break;
         When = "04" /* No Approval, No EE Review Held */
            &rowMgrSubUpdateandComplete.Visible = True;
            
            Break;
         When = "05" /* Approval, No EE Review Held */
            /* Set label for Complete Sub-step */
            &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            Evaluate &HeaderRec.EP_APPROVAL_STATUS.Value
            When = "OPEN" /* Open (i.e. not submitted yet) */
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               Break;
               
            When = "DENY" /* Denied */
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               Break;
            When = "SUBM" /* Submitted */
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubApproval.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               Break;
            When = "APRV" /* Approved */
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubApproval.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               
               Break;
            End-Evaluate;
         End-Evaluate;
         Break;
         
      When = "E" /* Employee */
         Evaluate &HeaderRec.EP_EE_REVIEW_FLG.Value
         When = "01" /* Approval Before EE Review Held */
         When = "03" /* No Approval Review Held */
            
            
            &rowMgrSubUpdateandSubmit.Visible = False;
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            /* When Confirmation set the focus on the current step */
            If &Ismanagerstepcurrent Then
               If &Gbl_same_focus Then
                  &rowMgrSubReqestAcknowledgement.Style = "PSGRIDROWSELECTED";
               Else
                  
               End-If;
            End-If;
            /*EE: Review with Manager */
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB5", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* EE: Acknowledge */
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            &rowMgrSubComplete.Visible = False;
            
            /* EE: View */
            
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            
            /* 92 FP1 Add Flow 07 and flow 06*/
            
         When = "07" /* Approval Before 2 Process */
         When = "06" /* No Approval 2 Process */
            
            
            &rowMgrSubUpdateandSubmit.Visible = False;
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = False;
            
            
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* EE: Acknowledge */
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            
            rem &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            rem  &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            &rowMgrSubComplete.Visible = False;
            
            /* EE: View */
            
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            
            
         When = "02" /* Approval After EE Reivew Held */
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            /*EE: Review with Manager */
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB5", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* EE: Acknowledge */
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            /* When Confirmation set the focus on the current step */
            If &Ismanagerstepcurrent Then
               If &Gbl_same_focus Then
                  &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
               Else
                  
               End-If;
            End-If;
            
            /* EE: View */
            
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            
            /* 92 FP1 Add flow 08 Approavl after 3 steps process */
         When = "08" /* Approval After 3 steps process */
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = False;
            
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* EE: Acknowledge */
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            /* When Confirmation set the focus on the current step */
            If &Ismanagerstepcurrent Then
               If &Gbl_same_focus Then
                  &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
               Else
                  
               End-If;
            End-If;
            
            /* EE: View */
            
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            
         When = "04" /* No Approval No Review Held */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         When = "05" /* Approval No Review Held */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            
            Break;
         When-Other
            Break;
            
         End-Evaluate;
         /* Flow 1 hide the substep icons when it's Pending Approval */
         If &HeaderRec.EP_EE_REVIEW_FLG.Value = "01" Then
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
         End-If;
         
      When = "H"
      When = "V"
         
         /* If User Role is Admin, View only and Approver, Show View, Hide Update, Hide Update and Approve */
         &rowMgrSubView.Visible = True;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
         
         Break;
      When-Other
         Break;
         
      End-Evaluate;
      
      Break;
      
   When = "NS"
   When = "IP"
      
      Evaluate &EP_GBLKEYS_WRK.EP_USER_ROLE.Value
      When = "M" /* Manager */
         
         Evaluate &HeaderRec.EP_EE_REVIEW_FLG.Value
         When = "01" /* Approval Before EE Review Held */
            Evaluate &HeaderRec.EP_APPROVAL_STATUS.Value
            When = "OPEN" /* Open (i.e. not submitted yet) */
               
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
            When = "DENY" /* Denied */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
            When = "SUBM"; /* Submitted */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubApproval.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               Break;
            When = "APRV"; /* Approved (isn't possible to be approved and still in progress) */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               Break;
            End-Evaluate;
            /* 92 FP1 Add flow 07*/
         When = "07" /* Approval Before 2 steps process */
            Evaluate &HeaderRec.EP_APPROVAL_STATUS.Value
            When = "OPEN" /* Open (i.e. not submitted yet) */
               
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               
               Break;
            When = "DENY" /* Denied */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               
               Break;
            When = "SUBM"; /* Submitted */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubApproval.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               Break;
            When = "APRV"; /* Approved (isn't possible to be approved and still in progress) */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               Break;
            End-Evaluate;
            
            
         When = "02" /* Approval After EE Review Held */
            Evaluate &HeaderRec.EP_APPROVAL_STATUS.Value
            When = "OPEN" /* Open (i.e. not submitted yet) */
               
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Flow 2 - change view link label to Complete */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               
               Break;
               
            When = "DENY" /* Denied */
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Flow 2 - change view link label to Complete */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               
               Break;
               
            When = "SUBM" /* Submitted */
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               
               
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubPA.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Flow 2 - change view link label to Complete */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               
               Break;
            When = "APRV" /* Approved */
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               /* Flow 2 - change view link label to Complete */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               
               Break;
            When-Other
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               /* Flow 2 - Other role able to view, label changes back to View */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               
               Break;
               
            End-Evaluate;
            /* 92 FP1 Added flow 08 */
            
         When = "08" /* Approval After 3 steps process */
            Evaluate &HeaderRec.EP_APPROVAL_STATUS.Value
            When = "OPEN" /* Open (i.e. not submitted yet) */
               
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               Break;
            When = "DENY" /* Denied */
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               
               Break;
            When = "SUBM" /* Submitted */
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               
               
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubPA.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               
               Break;
            When = "APRV" /* Approved */
               &rowMgrSubUpdateandShare.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               /* Sumbit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               
               Break;
            When-Other
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               /* Flow 2 - Other role able to view, label changes back to View */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
               
               Break;
               
            End-Evaluate;
         When = "03" /* No Approval, EE Review Held */
            
            &rowMgrSubUpdateandShare.Visible = True;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If &Ismanagerstepcurrent Then
               If &Gbl_same_focus Then
               Else
                  &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
            &rowMgrSubReqestAcknowledgement.Visible = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowMgrSubComplete.Visible = True;
            &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* Complete */
            &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            Break;
            
            /* 92 FP1 Added Flow 06 */
         When = "06" /* No Approval 2 steps process */
            
            &rowMgrSubUpdateandShare.Visible = True;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If &Ismanagerstepcurrent Then
               If &Gbl_same_focus Then
               Else
                  &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
            
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            
            Break;
         When = "04" /* No Approval, No EE Review Held */
            &rowMgrSubUpdateandComplete.Visible = True;
            &rowMgrSubUpdateandComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubUpdateandComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubUpdateandComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowMgrSubUpdateandComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If &Ismanagerstepcurrent Then
               If &Gbl_same_focus Then
               Else
                  &rowMgrSubUpdateandComplete.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
            
            Break;
         When = "05" /* Approval, No EE Review Held */
            /* Set label Complete sub-step */
            &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            Evaluate &HeaderRec.EP_APPROVAL_STATUS.Value
            When = "OPEN" /* Open (i.e. not submitted yet) */
               
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               Break;
               
            When = "DENY" /* Denied */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               Break;
               
            When = "SUBM" /* Submitted */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubUpdateandSubmit.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubApproval.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               
               Break;
            When = "APRV" /* Approved */
               &rowMgrSubUpdateandSubmit.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubApproval.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubApproval.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubComplete.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               
               Break;
            End-Evaluate;
         End-Evaluate;
         
         
      When = "E" /* Employee */
         Evaluate &HeaderRec.EP_EE_REVIEW_FLG.Value
         When = "01" /* Approval Before EE Review Held */
         When = "02" /* Approval After Review */
         When = "03" /* No Approval Review Held */
            
            
            &rowMgrSubUpdateandSubmit.Visible = False;
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /*EE: Review with Manager */
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB5", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* EE: Acknowledge */
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubComplete.Visible = False;
            
            /* EE: View */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* 92FP1 Add Flow 06, Flow 07 and Flow 08 */
         When = "06" /* No Approval 2 steps process */
            
         When = "07" /* Approval Before 2 steps process */
            &rowMgrSubUpdateandSubmit.Visible = False;
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = False;
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* EE: Acknowledge */
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubComplete.Visible = False;
            
            /* EE: View */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            
            
         When = "08" /* Approval After 3 steps process */
            &rowMgrSubUpdateandSubmit.Visible = False;
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = False;
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* EE: Acknowledge */
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubComplete.Visible = False;
            /* EE: View */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         When = "04" /* No Approval No Review Held */
         When = "05" /* Approval No Review Held */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            
            Break;
         When-Other
            Break;
         End-Evaluate;
         
         
      When-Other
         
         &rowMgrSubView.Visible = True;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
         /*If Manager Evaluation hasn't started, disable the View link when Admin/View-Only logs in */
         If &strMgrDocStatus = "NS" Then
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         End-If;
         Break;
         
      End-Evaluate;
      
      Break;
      
   When = "AR" /* Available for Review, or Share with Employee */
      Evaluate &HeaderRec.EP_EE_REVIEW_FLG.Value
      When = "01"
         &rowMgrSubUpdateandSubmit.Visible = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubApproval.Visible = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         &rowMgrSubReqestAcknowledgement.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               &rowMgrSubReqestAcknowledgement.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubComplete.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubPA.Visible = False;
         
      When = "02"
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         &rowMgrSubReqestAcknowledgement.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               &rowMgrSubReqestAcknowledgement.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubComplete.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         /* Sumbit for Approval */
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubPA.Visible = True;
         &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubView.Visible = True;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         /*Flow 2- Only manager role change view link label to Complete */
         If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "M" Then
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            
         Else
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            
         End-If;
         Break;
      When = "03"
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         &rowMgrSubReqestAcknowledgement.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               
            Else
               &rowMgrSubReqestAcknowledgement.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubComplete.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         /* Complete */
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
         Break;
      When = "04"
      When = "05"
      When-Other
         Break;
      End-Evaluate;
      
      /* Change the sub step name for Employee Role */
      
      If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "E" Then
         Evaluate &HeaderRec.EP_EE_REVIEW_FLG.Value
         When = "01" /* Approval Before EE Review Held */
         When = "02" /* Approval After Review */
         When = "03" /* No Approval Review Held */
            
            
            &rowMgrSubUpdateandSubmit.Visible = False;
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If &Ismanagerstepcurrent Then
               If &Gbl_same_focus Then
               Else
                  &rowMgrSubReqestAcknowledgement.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
            /*EE: Review with Manager */
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB5", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* EE: Acknowledge */
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubComplete.Visible = False;
            /* EE: View */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            /* EE should have view link show */
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         When = "04" /* No Approval No Review Held */
         When = "05" /* Approval No Review Held */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            /*View */
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            
            Break;
            
         When-Other
            Break;
         End-Evaluate;
         
      End-If;
      
      If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
            &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
         
         &rowMgrSubUpdateandSubmit.Visible = False;
         &rowMgrSubApproval.Visible = False;
         &rowMgrSubUpdateandComplete.Visible = False;
         &rowMgrSubUpdateandShare.Visible = False;
         &rowMgrSubPA.Visible = False;
         &rowMgrSubReqestAcknowledgement.Visible = False;
         &rowMgrSubOverrideAcknowledgement.Visible = False;
         &rowMgrSubComplete.Visible = False;
         &rowMgrSubView.Visible = True;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         /*View */
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
      End-If;
      
   When = "RH" /* Review Held */
      
      Evaluate &HeaderRec.EP_EE_REVIEW_FLG.Value
      When = "01"
         
         &rowMgrSubUpdateandSubmit.Visible = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubApproval.Visible = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubReqestAcknowledgement.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubReqestAcknowledgement.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowMgrSubComplete.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
         /*  92 FP1 added Flow 07 */
         
      When = "07"
         &rowMgrSubUpdateandSubmit.Visible = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubApproval.Visible = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               &rowMgrSubReqestAcknowledgement.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         
         &rowMgrSubComplete.Visible = False;
         &rowMgrSubPA.Visible = False;
      When = "02"
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubReqestAcknowledgement.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubReqestAcknowledgement.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowMgrSubComplete.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         /* Sumbit for Approval */
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubPA.Visible = True;
         &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubView.Visible = True;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
         Break;
         /* 92 FP1 added Flow 08 */
         
      When = "08"
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowMgrSubComplete.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         /* Sumbit for Approval */
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubPA.Visible = True;
         &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         Break;
      When = "03"
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubReqestAcknowledgement.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubReqestAcknowledgement.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowMgrSubComplete.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         /* Complete */
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
         Break;
         
         /* 92FP1 Add Flow 06*/
      When = "06"
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubUpdateandShare.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         
         Break;
      When = "04"
      When = "05"
      When-Other
         Break;
      End-Evaluate;
      
      /* Change the sub step name for Employee Role */
      
      If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "E" Then
         
         Evaluate &HeaderRec.EP_EE_REVIEW_FLG.Value
         When = "01" /* Approval Before EE Review Held */
         When = "02" /* Approval After Review */
         When = "03" /* No Approval Review Held */
            
            
            &rowMgrSubUpdateandSubmit.Visible = False;
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            /* When Confirmation set the focus on the current step */
            If &Ismanagerstepcurrent Then
               If &Gbl_same_focus Then
                  &rowMgrSubReqestAcknowledgement.Style = "PSGRIDROWSELECTED";
               Else
                  
               End-If;
            End-If;
            /*EE: Review with Manager */
            &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB5", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If &Ismanagerstepcurrent Then
               If &Gbl_same_focus Then
               Else
                  &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
            /* EE: Acknowledge */
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubComplete.Visible = False;
            
            /* EE: View */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            /* 92 FP1 Add flow 06, 07 and 08 */
         When = "06"
         When = "07"
            
            &rowMgrSubUpdateandSubmit.Visible = False;
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = False;
            
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If &Ismanagerstepcurrent Then
               If &Gbl_same_focus Then
               Else
                  &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
            /* EE: Acknowledge */
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            &rowMgrSubComplete.Visible = False;
            
            /* EE: View */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            Break;
         When = "08"
            &rowMgrSubUpdateandSubmit.Visible = False;
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = False;
            
            &rowMgrSubOverrideAcknowledgement.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
            
            If &Ismanagerstepcurrent Then
               If &Gbl_same_focus Then
               Else
                  &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
            /* EE: Acknowledge */
            &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            <* &rowMgrSubComplete.Visible = True;
            &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " "); *>
            &rowMgrSubComplete.Visible = False;
            /* EE: View */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
            
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            
            Break;
         When = "04" /* No Approval No Review Held */
         When = "05" /* Approval No Review Held */
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
            
            Break;
         When-Other
            Break;
         End-Evaluate;
         
         /*EE: Review with Manager */
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB5", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         /*EE: Acknowledge */
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         /*EE: View */
         rem  &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      End-If;
      
      If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
            &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
         
         &rowMgrSubUpdateandSubmit.Visible = False;
         &rowMgrSubApproval.Visible = False;
         &rowMgrSubUpdateandComplete.Visible = False;
         &rowMgrSubUpdateandShare.Visible = False;
         &rowMgrSubPA.Visible = False;
         &rowMgrSubReqestAcknowledgement.Visible = False;
         &rowMgrSubOverrideAcknowledgement.Visible = False;
         &rowMgrSubComplete.Visible = False;
         &rowMgrSubView.Visible = True;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
      End-If;
      
   When = "AK" /* Acknowledged */
      
      Evaluate &HeaderRec.EP_EE_REVIEW_FLG.Value
      When = "01"
         
         &rowMgrSubUpdateandSubmit.Visible = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubApproval.Visible = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB4_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubReqestAcknowledgement.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         &rowMgrSubComplete.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
      When = "02"
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubReqestAcknowledgement.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         &rowMgrSubComplete.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               /* Only Manager Role set focus */
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "M" Then
                  &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
         End-If;
         /* Sumbit for Approval */
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubPA.Visible = True;
         &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubView.Visible = True;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         /* Flow 2- change to complete */
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
         Break;
         /* 92 FP1 add flow 08 */
      When = "08"
         
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         &rowMgrSubComplete.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               /* Only Manager Role set focus */
               If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "M" Then
                  &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
               End-If;
            End-If;
         End-If;
         /* Sumbit for Approval */
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         &rowMgrSubPA.Visible = True;
         &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         rem &rowMgrSubView.Visible = True;
         rem &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         /* Flow 2- change to complete */
         rem &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
         Break;
      When = "03"
         &rowMgrSubUpdateandShare.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubReqestAcknowledgement.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         &rowMgrSubOverrideAcknowledgement.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
         &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         /* When Confirmation set the focus on the current step */
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
               &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
            Else
               
            End-If;
         End-If;
         &rowMgrSubComplete.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
         
         If &Ismanagerstepcurrent Then
            If &Gbl_same_focus Then
            Else
               &rowMgrSubComplete.Style = "PSGRIDROWSELECTED";
            End-If;
         End-If;
         /* Complete */
         &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         Break;
      When = "04"
      When = "05"
      When-Other
         Break;
      End-Evaluate;
      /* Only the manager can 'complete' or 'submit'. */
      If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "M" Then
         /* When Process Flow is 'Approval After EE Review Held' */
         /* sub-step displays 'Submit for Approval'.  */
         
         If &HeaderRec.EP_EE_REVIEW_FLG.Value = "02" Then
            Evaluate &HeaderRec.EP_APPROVAL_STATUS.Value
            When = "OPEN"
            When = "DENY"
               /*Submit for Approval */
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB7_ALT", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubPA.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               Break;
            When = "SUBM"
               &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_IN_PROGRESS;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON2", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                  Else
                     &rowMgrSubPA.Style = "PSGRIDROWSELECTED";
                  End-If;
               End-If;
               /* view */
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB2", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               Break;
            When = "APRV"
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubPA.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               /* View */
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               Break;
               
            End-Evaluate;
         Else
            
            Break;
         End-If;
      Else
         If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "E" Then
            Evaluate &HeaderRec.EP_EE_REVIEW_FLG.Value
            When = "01" /* Approval Before EE Review Held */
            When = "02" /* Approval After Review */
            When = "03" /* No Approval Review Held */
               
               
               &rowMgrSubUpdateandSubmit.Visible = False;
               &rowMgrSubApproval.Visible = False;
               &rowMgrSubUpdateandComplete.Visible = False;
               &rowMgrSubUpdateandShare.Visible = False;
               &rowMgrSubPA.Visible = False;
               &rowMgrSubReqestAcknowledgement.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /*EE: Review with Manager */
               &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB5", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* EE: Acknowledge */
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               
               &rowMgrSubComplete.Visible = False;
               
               /* EE doesn't need to set focus for view link here*/
               /* EE: View */
               
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               /* 92 FP1 added flow 08 */
               
            When = "08"
               &rowMgrSubUpdateandSubmit.Visible = False;
               &rowMgrSubApproval.Visible = False;
               &rowMgrSubUpdateandComplete.Visible = False;
               &rowMgrSubUpdateandShare.Visible = False;
               &rowMgrSubPA.Visible = False;
               &rowMgrSubReqestAcknowledgement.Visible = False;
               &rowMgrSubOverrideAcknowledgement.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.DisplayOnly = True;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.LabelImage = Image.PTAI_COMPLETED;
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Label = GetText("APPR_WC_ICON3", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ");
               
               /* EE: Acknowledge */
               &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB6", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               /* When Confirmation set the focus on the current step */
               If &Ismanagerstepcurrent Then
                  If &Gbl_same_focus Then
                     &rowMgrSubOverrideAcknowledgement.Style = "PSGRIDROWSELECTED";
                  Else
                     
                  End-If;
               End-If;
               
               &rowMgrSubComplete.Visible = False;
               
               /* EE: View */
               
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
               
            When = "04" /* No Approval No Review Held */
            When = "05" /* Approval No Review Held */
               &rowMgrSubView.Visible = True;
               &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
               
               Break;
            When-Other
               Break;
            End-Evaluate;
            
         End-If;
         If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "V" Or
               &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "H" Then
            
            &rowMgrSubUpdateandSubmit.Visible = False;
            &rowMgrSubApproval.Visible = False;
            &rowMgrSubUpdateandComplete.Visible = False;
            &rowMgrSubUpdateandShare.Visible = False;
            &rowMgrSubPA.Visible = False;
            &rowMgrSubReqestAcknowledgement.Visible = False;
            &rowMgrSubOverrideAcknowledgement.Visible = False;
            &rowMgrSubComplete.Visible = False;
            &rowMgrSubView.Visible = True;
            &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
            
         End-If;
      End-If;
      
   When = "CO" /* Complete */
      
   When = "CA" /* Cancelled */
      
      &rowMgrSubUpdateandSubmit.Visible = False;
      &rowMgrSubApproval.Visible = False;
      &rowMgrSubUpdateandComplete.Visible = False;
      &rowMgrSubUpdateandShare.Visible = False;
      &rowMgrSubReqestAcknowledgement.Visible = False;
      &rowMgrSubOverrideAcknowledgement.Visible = False;
      &rowMgrSubComplete.Visible = False;
      &rowMgrSubPA.Visible = False;
      
      /* 22526401 - hide the view link when manager role doc does not exist */
      If &bolMgrDocDoesExist = False And
            &strMgrDocStatus = "CA" Then
         &rowMgrSubView.Visible = False;
      Else
         &rowMgrSubView.Visible = True;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = False;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
      End-If;
      
      Break;
   End-Evaluate;
   
   
   /* When Manager Document is canceled, EE Logs in, View link should be disabled */
   If &HeaderRec.EP_REVIEW_STATUS.Value = "CA" Then
      
      If &EP_GBLKEYS_WRK.EP_USER_ROLE.Value <> "M" Then
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
         &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.Label = GetText("MGR_SUB9", " ", " ", " ", &EP_GBLKEYS_WRK.EP_USER_ROLE.Value, "", " ", " ", " ", " ", " ");
         
      End-If;
   End-If;
   
   /* When Establish Criteria/Track Progress is not started or in Progress, disable all manager Evaluation sub-steps */
   If &HeaderRec.EP_EST_STATUS.Value = "NS" Or
         &HeaderRec.EP_EST_STATUS.Value = "IP" Or
         &HeaderRec.EP_TRKPROG_STATUS.Value = "NS" Or
         &HeaderRec.EP_TRKPROG_STATUS.Value = "IP" Then
      &rowMgrSubUpdateandComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubUpdateandComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubView.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   End-If;
   
   /* When EE access the workcenter, EE Evaluation is in progress and Manager Evaluation is not started */
   /*  hide all Manager Evaluation Sub-Steps */
   /* or When EE Access the workcenter, EE Evaluation is not started and Manager Evalaution is not started */
   /* hide all Manager Evaluation Sub-Steps */
   If (&strEmpDocStatus = "NS" Or
         &strEmpDocStatus = "IP") And
         &strMgrDocStatus = "NS" And
         &EP_GBLKEYS_WRK.EP_USER_ROLE.Value = "E" Then
      &rowMgrSubUpdateandComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubPA.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubView.EP_BTN_LINK_WRK.EP_SUBSTEP_LINK.DisplayOnly = True;
      &rowMgrSubUpdateandComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubUpdateandShare.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubUpdateandSubmit.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubApproval.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubReqestAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubOverrideAcknowledgement.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubComplete.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubPA.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
      &rowMgrSubView.EP_BTN_LINK_WRK.EP_STEP_STATUS_IMG.Visible = False;
   End-If;
end-method;

